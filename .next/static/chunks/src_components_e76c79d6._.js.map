{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\nimport { cn } from \"~/lib/utils\";\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n);\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants };\n"],"names":[],"mappings":";;;;;;;AACA;AACA;;;;AAEA,MAAM,gBAAgB,IAAA,0KAAG,EACvB,wKACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SAAS;QACX;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAOF,SAAS,MAAM,KAA4C;QAA5C,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAmB,GAA5C;IACb,qBACE,6LAAC;QAAI,WAAW,IAAA,4HAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QAAa,GAAG,KAAK;;;;;;AAExE;KAJS","debugId":null}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/editor/nodes/MentionNode.tsx"],"sourcesContent":["import {\n  type DOMConversionMap,\n  type DOMExportOutput,\n  type EditorConfig,\n  type LexicalNode,\n  type NodeKey,\n  type SerializedTextNode,\n  type Spread,\n  TextNode,\n} from \"lexical\";\n\nexport type MentionType = \"user\" | \"project\";\n\nexport type SerializedMentionNode = Spread<\n  {\n    mentionType: MentionType;\n    mentionId: string;\n    mentionName: string;\n  },\n  SerializedTextNode\n>;\n\nexport class MentionNode extends TextNode {\n  __mentionType: MentionType;\n  __mentionId: string;\n  __mentionName: string;\n\n  static getType(): string {\n    return \"mention\";\n  }\n\n  static clone(node: MentionNode): MentionNode {\n    return new MentionNode(\n      node.__mentionType,\n      node.__mentionId,\n      node.__mentionName,\n      node.__key\n    );\n  }\n\n  constructor(\n    mentionType: MentionType,\n    mentionId: string,\n    mentionName: string,\n    key?: NodeKey\n  ) {\n    super(`@${mentionName}`, key);\n    this.__mentionType = mentionType;\n    this.__mentionId = mentionId;\n    this.__mentionName = mentionName;\n  }\n\n  createDOM(config: EditorConfig): HTMLElement {\n    const element = super.createDOM(config);\n    element.className = \"mention\";\n    element.setAttribute(\"data-mention-type\", this.__mentionType);\n    element.setAttribute(\"data-mention-id\", this.__mentionId);\n    return element;\n  }\n\n  exportDOM(): DOMExportOutput {\n    const element = document.createElement(\"span\");\n    element.className = \"mention\";\n    element.setAttribute(\"data-mention-type\", this.__mentionType);\n    element.setAttribute(\"data-mention-id\", this.__mentionId);\n    element.textContent = `@${this.__mentionName}`;\n    return { element };\n  }\n\n  static importDOM(): DOMConversionMap | null {\n    return {\n      span: (domNode: HTMLElement) => {\n        if (!domNode.classList.contains(\"mention\")) {\n          return null;\n        }\n        return {\n          conversion: (element) => {\n            const mentionType =\n              (element.getAttribute(\"data-mention-type\") as MentionType) ||\n              \"user\";\n            const mentionId = element.getAttribute(\"data-mention-id\") || \"\";\n            const mentionName =\n              element.textContent?.replace(\"@\", \"\") || \"\";\n            return {\n              node: $createMentionNode(mentionType, mentionId, mentionName),\n            };\n          },\n          priority: 1,\n        };\n      },\n    };\n  }\n\n  static importJSON(serializedNode: SerializedMentionNode): MentionNode {\n    return $createMentionNode(\n      serializedNode.mentionType,\n      serializedNode.mentionId,\n      serializedNode.mentionName\n    );\n  }\n\n  exportJSON(): SerializedMentionNode {\n    return {\n      ...super.exportJSON(),\n      type: \"mention\",\n      mentionType: this.__mentionType,\n      mentionId: this.__mentionId,\n      mentionName: this.__mentionName,\n    };\n  }\n\n  getMentionType(): MentionType {\n    return this.__mentionType;\n  }\n\n  getMentionId(): string {\n    return this.__mentionId;\n  }\n\n  getMentionName(): string {\n    return this.__mentionName;\n  }\n\n  canInsertTextBefore(): boolean {\n    return false;\n  }\n\n  canInsertTextAfter(): boolean {\n    return false;\n  }\n\n  isTextEntity(): boolean {\n    return true;\n  }\n}\n\nexport function $createMentionNode(\n  mentionType: MentionType,\n  mentionId: string,\n  mentionName: string\n): MentionNode {\n  return new MentionNode(mentionType, mentionId, mentionName).setMode(\"token\");\n}\n\nexport function $isMentionNode(\n  node: LexicalNode | null | undefined\n): node is MentionNode {\n  return node instanceof MentionNode;\n}\n"],"names":[],"mappings":";;;;;;;;;AAAA;;;AAsBO,MAAM,oBAAoB,yJAAQ;IAKvC,OAAO,UAAkB;QACvB,OAAO;IACT;IAEA,OAAO,MAAM,IAAiB,EAAe;QAC3C,OAAO,IAAI,YACT,KAAK,aAAa,EAClB,KAAK,WAAW,EAChB,KAAK,aAAa,EAClB,KAAK,KAAK;IAEd;IAcA,UAAU,MAAoB,EAAe;QAC3C,MAAM,UAAU,KAAK,CAAC,UAAU;QAChC,QAAQ,SAAS,GAAG;QACpB,QAAQ,YAAY,CAAC,qBAAqB,IAAI,CAAC,aAAa;QAC5D,QAAQ,YAAY,CAAC,mBAAmB,IAAI,CAAC,WAAW;QACxD,OAAO;IACT;IAEA,YAA6B;QAC3B,MAAM,UAAU,SAAS,aAAa,CAAC;QACvC,QAAQ,SAAS,GAAG;QACpB,QAAQ,YAAY,CAAC,qBAAqB,IAAI,CAAC,aAAa;QAC5D,QAAQ,YAAY,CAAC,mBAAmB,IAAI,CAAC,WAAW;QACxD,QAAQ,WAAW,GAAG,AAAC,IAAsB,OAAnB,IAAI,CAAC,aAAa;QAC5C,OAAO;YAAE;QAAQ;IACnB;IAEA,OAAO,YAAqC;QAC1C,OAAO;YACL,MAAM,CAAC;gBACL,IAAI,CAAC,QAAQ,SAAS,CAAC,QAAQ,CAAC,YAAY;oBAC1C,OAAO;gBACT;gBACA,OAAO;oBACL,YAAY,CAAC;4BAMT;wBALF,MAAM,cACJ,AAAC,QAAQ,YAAY,CAAC,wBACtB;wBACF,MAAM,YAAY,QAAQ,YAAY,CAAC,sBAAsB;wBAC7D,MAAM,cACJ,EAAA,uBAAA,QAAQ,WAAW,cAAnB,2CAAA,qBAAqB,OAAO,CAAC,KAAK,QAAO;wBAC3C,OAAO;4BACL,MAAM,mBAAmB,aAAa,WAAW;wBACnD;oBACF;oBACA,UAAU;gBACZ;YACF;QACF;IACF;IAEA,OAAO,WAAW,cAAqC,EAAe;QACpE,OAAO,mBACL,eAAe,WAAW,EAC1B,eAAe,SAAS,EACxB,eAAe,WAAW;IAE9B;IAEA,aAAoC;QAClC,OAAO;YACL,GAAG,KAAK,CAAC,YAAY;YACrB,MAAM;YACN,aAAa,IAAI,CAAC,aAAa;YAC/B,WAAW,IAAI,CAAC,WAAW;YAC3B,aAAa,IAAI,CAAC,aAAa;QACjC;IACF;IAEA,iBAA8B;QAC5B,OAAO,IAAI,CAAC,aAAa;IAC3B;IAEA,eAAuB;QACrB,OAAO,IAAI,CAAC,WAAW;IACzB;IAEA,iBAAyB;QACvB,OAAO,IAAI,CAAC,aAAa;IAC3B;IAEA,sBAA+B;QAC7B,OAAO;IACT;IAEA,qBAA8B;QAC5B,OAAO;IACT;IAEA,eAAwB;QACtB,OAAO;IACT;IA7FA,YACE,WAAwB,EACxB,SAAiB,EACjB,WAAmB,EACnB,GAAa,CACb;QACA,KAAK,CAAC,AAAC,IAAe,OAAZ,cAAe,MAvB3B,+KAAA,iBAAA,KAAA,IACA,+KAAA,eAAA,KAAA,IACA,+KAAA,iBAAA,KAAA;QAsBE,IAAI,CAAC,aAAa,GAAG;QACrB,IAAI,CAAC,WAAW,GAAG;QACnB,IAAI,CAAC,aAAa,GAAG;IACvB;AAoFF;AAEO,SAAS,mBACd,WAAwB,EACxB,SAAiB,EACjB,WAAmB;IAEnB,OAAO,IAAI,YAAY,aAAa,WAAW,aAAa,OAAO,CAAC;AACtE;AAEO,SAAS,eACd,IAAoC;IAEpC,OAAO,gBAAgB;AACzB","debugId":null}},
    {"offset": {"line": 160, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/editor/nodes/ImageNode.tsx"],"sourcesContent":["import * as React from \"react\";\nimport {\n  type DOMConversionMap,\n  type DOMExportOutput,\n  type EditorConfig,\n  type LexicalNode,\n  type NodeKey,\n  type SerializedLexicalNode,\n  type Spread,\n  DecoratorNode,\n} from \"lexical\";\nimport { Suspense } from \"react\";\n\nexport type SerializedImageNode = Spread<\n  {\n    src: string;\n    altText: string;\n    width?: number;\n    height?: number;\n    caption?: string;\n  },\n  SerializedLexicalNode\n>;\n\nfunction ImageComponent({\n  src,\n  altText,\n  width,\n  height,\n}: {\n  src: string;\n  altText: string;\n  width?: number;\n  height?: number;\n}) {\n  return (\n    <div className=\"my-4\">\n      <img\n        src={src}\n        alt={altText}\n        width={width}\n        height={height}\n        className=\"max-w-full rounded-lg\"\n        loading=\"lazy\"\n      />\n    </div>\n  );\n}\n\nexport class ImageNode extends DecoratorNode<React.ReactElement> {\n  __src: string;\n  __altText: string;\n  __width?: number;\n  __height?: number;\n  __caption?: string;\n\n  static getType(): string {\n    return \"image\";\n  }\n\n  static clone(node: ImageNode): ImageNode {\n    return new ImageNode(\n      node.__src,\n      node.__altText,\n      node.__width,\n      node.__height,\n      node.__caption,\n      node.__key\n    );\n  }\n\n  constructor(\n    src: string,\n    altText: string,\n    width?: number,\n    height?: number,\n    caption?: string,\n    key?: NodeKey\n  ) {\n    super(key);\n    this.__src = src;\n    this.__altText = altText;\n    this.__width = width;\n    this.__height = height;\n    this.__caption = caption;\n  }\n\n  createDOM(_config: EditorConfig): HTMLElement {\n    const div = document.createElement(\"div\");\n    div.className = \"editor-image\";\n    return div;\n  }\n\n  updateDOM(): false {\n    return false;\n  }\n\n  exportDOM(): DOMExportOutput {\n    const element = document.createElement(\"img\");\n    element.setAttribute(\"src\", this.__src);\n    element.setAttribute(\"alt\", this.__altText);\n    if (this.__width) {\n      element.setAttribute(\"width\", this.__width.toString());\n    }\n    if (this.__height) {\n      element.setAttribute(\"height\", this.__height.toString());\n    }\n    return { element };\n  }\n\n  static importDOM(): DOMConversionMap | null {\n    return {\n      img: () => ({\n        conversion: (domNode: HTMLElement) => {\n          const img = domNode as HTMLImageElement;\n          const node = $createImageNode({\n            src: img.src,\n            altText: img.alt,\n            width: img.width || undefined,\n            height: img.height || undefined,\n          });\n          return { node };\n        },\n        priority: 0,\n      }),\n    };\n  }\n\n  static importJSON(serializedNode: SerializedImageNode): ImageNode {\n    return $createImageNode({\n      src: serializedNode.src,\n      altText: serializedNode.altText,\n      width: serializedNode.width,\n      height: serializedNode.height,\n      caption: serializedNode.caption,\n    });\n  }\n\n  exportJSON(): SerializedImageNode {\n    return {\n      type: \"image\",\n      version: 1,\n      src: this.__src,\n      altText: this.__altText,\n      width: this.__width,\n      height: this.__height,\n      caption: this.__caption,\n    };\n  }\n\n  getSrc(): string {\n    return this.__src;\n  }\n\n  getAltText(): string {\n    return this.__altText;\n  }\n\n  decorate(): React.ReactElement {\n    return (\n      <Suspense fallback={null}>\n        <ImageComponent\n          src={this.__src}\n          altText={this.__altText}\n          width={this.__width}\n          height={this.__height}\n        />\n      </Suspense>\n    );\n  }\n\n  isInline(): boolean {\n    return false;\n  }\n\n  isKeyboardSelectable(): boolean {\n    return true;\n  }\n}\n\nexport function $createImageNode({\n  src,\n  altText,\n  width,\n  height,\n  caption,\n}: {\n  src: string;\n  altText: string;\n  width?: number;\n  height?: number;\n  caption?: string;\n}): ImageNode {\n  return new ImageNode(src, altText, width, height, caption);\n}\n\nexport function $isImageNode(\n  node: LexicalNode | null | undefined\n): node is ImageNode {\n  return node instanceof ImageNode;\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 323, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/editor/nodes/AttachmentNode.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport {\n  type DOMExportOutput,\n  type EditorConfig,\n  type LexicalNode,\n  type NodeKey,\n  type SerializedLexicalNode,\n  type Spread,\n  DecoratorNode,\n} from \"lexical\";\nimport { Suspense, useEffect, useState } from \"react\";\nimport { FileIcon, Download, Play, ExternalLink, Loader2 } from \"lucide-react\";\nimport { api } from \"~/lib/trpc/client\";\n\nexport type AttachmentType = \"IMAGE\" | \"VIDEO\" | \"FILE\" | \"FIGMA\" | \"LOOM\";\n\nexport type SerializedAttachmentNode = Spread<\n  {\n    attachmentType: AttachmentType;\n    url: string;\n    filename: string;\n    mimeType: string;\n    size: number;\n    thumbnailUrl?: string;\n    width?: number;\n    height?: number;\n    metadata?: Record<string, unknown>;\n  },\n  SerializedLexicalNode\n>;\n\nfunction formatFileSize(bytes: number): string {\n  if (bytes < 1024) return `${bytes} B`;\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n  return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n}\n\n// Extract R2 key from URL if it's an R2 URL\nfunction extractR2Key(url: string): string | null {\n  // Match patterns like:\n  // https://bucket.accountid.r2.cloudflarestorage.com/uploads/userid/timestamp-filename\n  // https://custom-domain.com/uploads/userid/timestamp-filename\n  const match = url.match(/uploads\\/[^\\/]+\\/[^\\/]+$/);\n  if (match) {\n    return match[0];\n  }\n  return null;\n}\n\nfunction AttachmentComponent({\n  attachmentType,\n  url,\n  filename,\n  mimeType,\n  size,\n  thumbnailUrl,\n  width,\n  height,\n}: {\n  attachmentType: AttachmentType;\n  url: string;\n  filename: string;\n  mimeType: string;\n  size: number;\n  thumbnailUrl?: string;\n  width?: number;\n  height?: number;\n}) {\n  const [displayUrl, setDisplayUrl] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  const r2Key = extractR2Key(url);\n  const { data: signedUrlData, isLoading: isLoadingUrl, error: urlError } = api.upload.getDownloadUrl.useQuery(\n    { key: r2Key! },\n    {\n      enabled: !!r2Key && (attachmentType === \"IMAGE\" || attachmentType === \"VIDEO\"),\n      staleTime: 30 * 60 * 1000, // Cache for 30 minutes (URL expires in 1 hour)\n      refetchOnWindowFocus: false,\n    }\n  );\n\n  useEffect(() => {\n    if (attachmentType !== \"IMAGE\" && attachmentType !== \"VIDEO\") {\n      // For non-media types, use original URL\n      setDisplayUrl(url);\n      setIsLoading(false);\n      return;\n    }\n\n    if (!r2Key) {\n      // If we can't extract a key, try using the URL directly\n      setDisplayUrl(url);\n      setIsLoading(false);\n      return;\n    }\n\n    if (signedUrlData) {\n      setDisplayUrl(signedUrlData.url);\n      setIsLoading(false);\n    } else if (urlError) {\n      // If signed URL fails, try original URL\n      setDisplayUrl(url);\n      setIsLoading(false);\n      setError(\"Could not load signed URL, trying direct URL\");\n    } else if (isLoadingUrl) {\n      setIsLoading(true);\n    }\n  }, [attachmentType, url, r2Key, signedUrlData, urlError, isLoadingUrl]);\n\n  if (attachmentType === \"IMAGE\") {\n    if (isLoading) {\n      return (\n        <div className=\"my-4 flex h-48 items-center justify-center rounded-lg bg-muted\">\n          <Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"my-4\">\n        <img\n          src={displayUrl || url}\n          alt={filename}\n          width={width}\n          height={height}\n          className=\"max-w-full rounded-lg\"\n          loading=\"lazy\"\n          onError={(e) => {\n            // If image fails to load, show error state\n            const target = e.target as HTMLImageElement;\n            target.style.display = 'none';\n            console.error(\"Image failed to load:\", displayUrl || url);\n          }}\n        />\n      </div>\n    );\n  }\n\n  if (attachmentType === \"VIDEO\") {\n    if (isLoading) {\n      return (\n        <div className=\"my-4 flex h-48 items-center justify-center rounded-lg bg-muted\">\n          <Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"my-4\">\n        <video\n          src={displayUrl || url}\n          poster={thumbnailUrl}\n          controls\n          className=\"max-w-full rounded-lg\"\n        >\n          <track kind=\"captions\" />\n        </video>\n      </div>\n    );\n  }\n\n  if (attachmentType === \"FIGMA\") {\n    return (\n      <a\n        href={url}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        className=\"my-4 flex items-center gap-3 rounded-lg border border-border bg-card p-4 transition-colors hover:bg-muted\"\n      >\n        <div className=\"flex h-10 w-10 items-center justify-center rounded-lg bg-[#1e1e1e]\">\n          <svg viewBox=\"0 0 38 57\" className=\"h-6 w-6\" fill=\"none\">\n            <path\n              d=\"M19 28.5a9.5 9.5 0 1 1 19 0 9.5 9.5 0 0 1-19 0z\"\n              fill=\"#1ABCFE\"\n            />\n            <path\n              d=\"M0 47.5A9.5 9.5 0 0 1 9.5 38H19v9.5a9.5 9.5 0 1 1-19 0z\"\n              fill=\"#0ACF83\"\n            />\n            <path\n              d=\"M19 0v19h9.5a9.5 9.5 0 1 0 0-19H19z\"\n              fill=\"#FF7262\"\n            />\n            <path\n              d=\"M0 9.5A9.5 9.5 0 0 0 9.5 19H19V0H9.5A9.5 9.5 0 0 0 0 9.5z\"\n              fill=\"#F24E1E\"\n            />\n            <path\n              d=\"M0 28.5A9.5 9.5 0 0 0 9.5 38H19V19H9.5A9.5 9.5 0 0 0 0 28.5z\"\n              fill=\"#A259FF\"\n            />\n          </svg>\n        </div>\n        <div className=\"flex-1 overflow-hidden\">\n          <p className=\"truncate font-medium\">{filename}</p>\n          <p className=\"text-sm text-muted-foreground\">Figma Design</p>\n        </div>\n        <ExternalLink className=\"h-4 w-4 text-muted-foreground\" />\n      </a>\n    );\n  }\n\n  if (attachmentType === \"LOOM\") {\n    return (\n      <a\n        href={url}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        className=\"my-4 flex items-center gap-3 rounded-lg border border-border bg-card p-4 transition-colors hover:bg-muted\"\n      >\n        <div className=\"flex h-10 w-10 items-center justify-center rounded-lg bg-[#625df5]\">\n          <Play className=\"h-5 w-5 fill-white text-white\" />\n        </div>\n        <div className=\"flex-1 overflow-hidden\">\n          <p className=\"truncate font-medium\">{filename}</p>\n          <p className=\"text-sm text-muted-foreground\">Loom Recording</p>\n        </div>\n        <ExternalLink className=\"h-4 w-4 text-muted-foreground\" />\n      </a>\n    );\n  }\n\n  // Generic file attachment - use signed URL for download\n  const downloadKey = extractR2Key(url);\n  const { data: downloadUrlData } = api.upload.getDownloadUrl.useQuery(\n    { key: downloadKey! },\n    {\n      enabled: !!downloadKey,\n      staleTime: 30 * 60 * 1000,\n      refetchOnWindowFocus: false,\n    }\n  );\n\n  return (\n    <a\n      href={downloadUrlData?.url || url}\n      download={filename}\n      className=\"my-4 flex items-center gap-3 rounded-lg border border-border bg-card p-4 transition-colors hover:bg-muted\"\n    >\n      <div className=\"flex h-10 w-10 items-center justify-center rounded-lg bg-muted\">\n        <FileIcon className=\"h-5 w-5 text-muted-foreground\" />\n      </div>\n      <div className=\"flex-1 overflow-hidden\">\n        <p className=\"truncate font-medium\">{filename}</p>\n        <p className=\"text-sm text-muted-foreground\">\n          {mimeType} Â· {formatFileSize(size)}\n        </p>\n      </div>\n      <Download className=\"h-4 w-4 text-muted-foreground\" />\n    </a>\n  );\n}\n\nexport class AttachmentNode extends DecoratorNode<React.ReactElement> {\n  __attachmentType: AttachmentType;\n  __url: string;\n  __filename: string;\n  __mimeType: string;\n  __size: number;\n  __thumbnailUrl?: string;\n  __width?: number;\n  __height?: number;\n  __metadata?: Record<string, unknown>;\n\n  static getType(): string {\n    return \"attachment\";\n  }\n\n  static clone(node: AttachmentNode): AttachmentNode {\n    return new AttachmentNode(\n      node.__attachmentType,\n      node.__url,\n      node.__filename,\n      node.__mimeType,\n      node.__size,\n      node.__thumbnailUrl,\n      node.__width,\n      node.__height,\n      node.__metadata,\n      node.__key\n    );\n  }\n\n  constructor(\n    attachmentType: AttachmentType,\n    url: string,\n    filename: string,\n    mimeType: string,\n    size: number,\n    thumbnailUrl?: string,\n    width?: number,\n    height?: number,\n    metadata?: Record<string, unknown>,\n    key?: NodeKey\n  ) {\n    super(key);\n    this.__attachmentType = attachmentType;\n    this.__url = url;\n    this.__filename = filename;\n    this.__mimeType = mimeType;\n    this.__size = size;\n    this.__thumbnailUrl = thumbnailUrl;\n    this.__width = width;\n    this.__height = height;\n    this.__metadata = metadata;\n  }\n\n  createDOM(_config: EditorConfig): HTMLElement {\n    const div = document.createElement(\"div\");\n    div.className = \"editor-attachment\";\n    return div;\n  }\n\n  updateDOM(): false {\n    return false;\n  }\n\n  exportDOM(): DOMExportOutput {\n    const element = document.createElement(\"div\");\n    element.setAttribute(\"data-attachment-type\", this.__attachmentType);\n    element.setAttribute(\"data-url\", this.__url);\n    element.setAttribute(\"data-filename\", this.__filename);\n    return { element };\n  }\n\n  static importJSON(serializedNode: SerializedAttachmentNode): AttachmentNode {\n    return $createAttachmentNode({\n      attachmentType: serializedNode.attachmentType,\n      url: serializedNode.url,\n      filename: serializedNode.filename,\n      mimeType: serializedNode.mimeType,\n      size: serializedNode.size,\n      thumbnailUrl: serializedNode.thumbnailUrl,\n      width: serializedNode.width,\n      height: serializedNode.height,\n      metadata: serializedNode.metadata,\n    });\n  }\n\n  exportJSON(): SerializedAttachmentNode {\n    return {\n      type: \"attachment\",\n      version: 1,\n      attachmentType: this.__attachmentType,\n      url: this.__url,\n      filename: this.__filename,\n      mimeType: this.__mimeType,\n      size: this.__size,\n      thumbnailUrl: this.__thumbnailUrl,\n      width: this.__width,\n      height: this.__height,\n      metadata: this.__metadata,\n    };\n  }\n\n  getUrl(): string {\n    return this.__url;\n  }\n\n  getFilename(): string {\n    return this.__filename;\n  }\n\n  decorate(): React.ReactElement {\n    return (\n      <Suspense fallback={<div className=\"my-4 h-48 animate-pulse rounded-lg bg-muted\" />}>\n        <AttachmentComponent\n          attachmentType={this.__attachmentType}\n          url={this.__url}\n          filename={this.__filename}\n          mimeType={this.__mimeType}\n          size={this.__size}\n          thumbnailUrl={this.__thumbnailUrl}\n          width={this.__width}\n          height={this.__height}\n        />\n      </Suspense>\n    );\n  }\n\n  isInline(): boolean {\n    return false;\n  }\n\n  isKeyboardSelectable(): boolean {\n    return true;\n  }\n}\n\nexport function $createAttachmentNode({\n  attachmentType,\n  url,\n  filename,\n  mimeType,\n  size,\n  thumbnailUrl,\n  width,\n  height,\n  metadata,\n}: {\n  attachmentType: AttachmentType;\n  url: string;\n  filename: string;\n  mimeType: string;\n  size: number;\n  thumbnailUrl?: string;\n  width?: number;\n  height?: number;\n  metadata?: Record<string, unknown>;\n}): AttachmentNode {\n  return new AttachmentNode(\n    attachmentType,\n    url,\n    filename,\n    mimeType,\n    size,\n    thumbnailUrl,\n    width,\n    height,\n    metadata\n  );\n}\n\nexport function $isAttachmentNode(\n  node: LexicalNode | null | undefined\n): node is AttachmentNode {\n  return node instanceof AttachmentNode;\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 857, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/editor/plugins/MentionPlugin.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport {\n  LexicalTypeaheadMenuPlugin,\n  MenuOption,\n  useBasicTypeaheadTriggerMatch,\n} from \"@lexical/react/LexicalTypeaheadMenuPlugin\";\nimport { TextNode } from \"lexical\";\nimport { createPortal } from \"react-dom\";\nimport { $createMentionNode, type MentionType } from \"../nodes/MentionNode\";\nimport { api } from \"~/lib/trpc/client\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"~/components/ui/avatar\";\nimport { getInitials } from \"~/lib/utils\";\nimport { FolderKanban, User } from \"lucide-react\";\n\nclass MentionOption extends MenuOption {\n  id: string;\n  name: string;\n  type: MentionType;\n  avatarUrl?: string | null;\n\n  constructor(\n    id: string,\n    name: string,\n    type: MentionType,\n    avatarUrl?: string | null\n  ) {\n    super(name);\n    this.id = id;\n    this.name = name;\n    this.type = type;\n    this.avatarUrl = avatarUrl;\n  }\n}\n\nfunction MentionMenuItem({\n  isSelected,\n  onClick,\n  onMouseEnter,\n  option,\n}: {\n  isSelected: boolean;\n  onClick: () => void;\n  onMouseEnter: () => void;\n  option: MentionOption;\n}) {\n  return (\n    <li\n      role=\"option\"\n      aria-selected={isSelected}\n      onClick={onClick}\n      onMouseEnter={onMouseEnter}\n      className={`flex cursor-pointer items-center gap-2 rounded-md px-2 py-1.5 text-sm ${\n        isSelected ? \"bg-accent text-accent-foreground\" : \"\"\n      }`}\n    >\n      {option.type === \"user\" ? (\n        <Avatar className=\"h-6 w-6\">\n          <AvatarImage src={option.avatarUrl ?? undefined} />\n          <AvatarFallback className=\"text-xs\">\n            {getInitials(option.name)}\n          </AvatarFallback>\n        </Avatar>\n      ) : (\n        <div className=\"flex h-6 w-6 items-center justify-center rounded-md bg-muted\">\n          <FolderKanban className=\"h-3.5 w-3.5\" />\n        </div>\n      )}\n      <span>{option.name}</span>\n      <span className=\"ml-auto text-xs text-muted-foreground\">\n        {option.type === \"user\" ? \"User\" : \"Project\"}\n      </span>\n    </li>\n  );\n}\n\nexport function MentionPlugin() {\n  const [editor] = useLexicalComposerContext();\n  const [queryString, setQueryString] = useState<string | null>(null);\n\n  const { data: users } = api.user.search.useQuery(\n    { query: queryString ?? \"\" },\n    { enabled: !!queryString && queryString.length > 0 }\n  );\n\n  const { data: projects } = api.project.search.useQuery(\n    { query: queryString ?? \"\" },\n    { enabled: !!queryString && queryString.length > 0 }\n  );\n\n  const checkForTriggerMatch = useBasicTypeaheadTriggerMatch(\"@\", {\n    minLength: 0,\n  });\n\n  const options = useMemo(() => {\n    const results: MentionOption[] = [];\n\n    if (users) {\n      results.push(\n        ...users.map(\n          (user) =>\n            new MentionOption(user.id, user.displayName, \"user\", user.avatarUrl)\n        )\n      );\n    }\n\n    if (projects) {\n      results.push(\n        ...projects.map(\n          (project) =>\n            new MentionOption(project.id, project.name, \"project\", project.coverUrl)\n        )\n      );\n    }\n\n    return results.slice(0, 10);\n  }, [users, projects]);\n\n  const onSelectOption = useCallback(\n    (\n      selectedOption: MentionOption,\n      nodeToReplace: TextNode | null,\n      closeMenu: () => void\n    ) => {\n      editor.update(() => {\n        const mentionNode = $createMentionNode(\n          selectedOption.type,\n          selectedOption.id,\n          selectedOption.name\n        );\n        if (nodeToReplace) {\n          nodeToReplace.replace(mentionNode);\n        }\n        mentionNode.select();\n        closeMenu();\n      });\n    },\n    [editor]\n  );\n\n  return (\n    <LexicalTypeaheadMenuPlugin<MentionOption>\n      onQueryChange={setQueryString}\n      onSelectOption={onSelectOption}\n      triggerFn={checkForTriggerMatch}\n      options={options}\n      menuRenderFn={(\n        anchorElementRef,\n        { selectedIndex, selectOptionAndCleanUp, setHighlightedIndex }\n      ) =>\n        anchorElementRef.current && options.length > 0\n          ? createPortal(\n              <div className=\"z-50 min-w-[200px] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md\">\n                <ul role=\"listbox\">\n                  {options.map((option, i) => (\n                    <MentionMenuItem\n                      key={option.id}\n                      isSelected={selectedIndex === i}\n                      onClick={() => {\n                        setHighlightedIndex(i);\n                        selectOptionAndCleanUp(option);\n                      }}\n                      onMouseEnter={() => {\n                        setHighlightedIndex(i);\n                      }}\n                      option={option}\n                    />\n                  ))}\n                </ul>\n              </div>,\n              anchorElementRef.current\n            )\n          : null\n      }\n    />\n  );\n}\n"],"names":[],"mappings":";;;;;;AAEA;AACA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;;;;AAfA;;;;;;;;;;AAiBA,MAAM,sBAAsB,yLAAU;IAMpC,YACE,EAAU,EACV,IAAY,EACZ,IAAiB,EACjB,SAAyB,CACzB;QACA,KAAK,CAAC,OAXR,+KAAA,MAAA,KAAA,IACA,+KAAA,QAAA,KAAA,IACA,+KAAA,QAAA,KAAA,IACA,+KAAA,aAAA,KAAA;QASE,IAAI,CAAC,EAAE,GAAG;QACV,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,SAAS,GAAG;IACnB;AACF;AAEA,SAAS,gBAAgB,KAUxB;QAVwB,EACvB,UAAU,EACV,OAAO,EACP,YAAY,EACZ,MAAM,EAMP,GAVwB;QAuBG;IAZ1B,qBACE,6LAAC;QACC,MAAK;QACL,iBAAe;QACf,SAAS;QACT,cAAc;QACd,WAAW,AAAC,yEAEX,OADC,aAAa,qCAAqC;;YAGnD,OAAO,IAAI,KAAK,uBACf,6LAAC,+IAAM;gBAAC,WAAU;;kCAChB,6LAAC,oJAAW;wBAAC,KAAK,CAAA,oBAAA,OAAO,SAAS,cAAhB,+BAAA,oBAAoB;;;;;;kCACtC,6LAAC,uJAAc;wBAAC,WAAU;kCACvB,IAAA,qIAAW,EAAC,OAAO,IAAI;;;;;;;;;;;qCAI5B,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,yOAAY;oBAAC,WAAU;;;;;;;;;;;0BAG5B,6LAAC;0BAAM,OAAO,IAAI;;;;;;0BAClB,6LAAC;gBAAK,WAAU;0BACb,OAAO,IAAI,KAAK,SAAS,SAAS;;;;;;;;;;;;AAI3C;KAvCS;AAyCF,SAAS;;IACd,MAAM,CAAC,OAAO,GAAG,IAAA,oMAAyB;IAC1C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAgB;IAE9D,MAAM,EAAE,MAAM,KAAK,EAAE,GAAG,sIAAG,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAC9C;QAAE,OAAO,wBAAA,yBAAA,cAAe;IAAG,GAC3B;QAAE,SAAS,CAAC,CAAC,eAAe,YAAY,MAAM,GAAG;IAAE;IAGrD,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,sIAAG,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,CACpD;QAAE,OAAO,wBAAA,yBAAA,cAAe;IAAG,GAC3B;QAAE,SAAS,CAAC,CAAC,eAAe,YAAY,MAAM,GAAG;IAAE;IAGrD,MAAM,uBAAuB,IAAA,4MAA6B,EAAC,KAAK;QAC9D,WAAW;IACb;IAEA,MAAM,UAAU,IAAA,wKAAO;0CAAC;YACtB,MAAM,UAA2B,EAAE;YAEnC,IAAI,OAAO;gBACT,QAAQ,IAAI,IACP,MAAM,GAAG;sDACV,CAAC,OACC,IAAI,cAAc,KAAK,EAAE,EAAE,KAAK,WAAW,EAAE,QAAQ,KAAK,SAAS;;YAG3E;YAEA,IAAI,UAAU;gBACZ,QAAQ,IAAI,IACP,SAAS,GAAG;sDACb,CAAC,UACC,IAAI,cAAc,QAAQ,EAAE,EAAE,QAAQ,IAAI,EAAE,WAAW,QAAQ,QAAQ;;YAG/E;YAEA,OAAO,QAAQ,KAAK,CAAC,GAAG;QAC1B;yCAAG;QAAC;QAAO;KAAS;IAEpB,MAAM,iBAAiB,IAAA,4KAAW;qDAChC,CACE,gBACA,eACA;YAEA,OAAO,MAAM;6DAAC;oBACZ,MAAM,cAAc,IAAA,6KAAkB,EACpC,eAAe,IAAI,EACnB,eAAe,EAAE,EACjB,eAAe,IAAI;oBAErB,IAAI,eAAe;wBACjB,cAAc,OAAO,CAAC;oBACxB;oBACA,YAAY,MAAM;oBAClB;gBACF;;QACF;oDACA;QAAC;KAAO;IAGV,qBACE,6LAAC,yMAA0B;QACzB,eAAe;QACf,gBAAgB;QAChB,WAAW;QACX,SAAS;QACT,cAAc,CACZ;gBACA,EAAE,aAAa,EAAE,sBAAsB,EAAE,mBAAmB,EAAE;mBAE9D,iBAAiB,OAAO,IAAI,QAAQ,MAAM,GAAG,kBACzC,IAAA,oLAAY,gBACV,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAG,MAAK;8BACN,QAAQ,GAAG,CAAC,CAAC,QAAQ,kBACpB,6LAAC;4BAEC,YAAY,kBAAkB;4BAC9B,SAAS;gCACP,oBAAoB;gCACpB,uBAAuB;4BACzB;4BACA,cAAc;gCACZ,oBAAoB;4BACtB;4BACA,QAAQ;2BATH,OAAO,EAAE;;;;;;;;;;;;;;wBActB,iBAAiB,OAAO,IAE1B;;;;;;;AAIZ;GApGgB;;QACG,oMAAyB;QAab,4MAA6B;;;MAd5C","debugId":null}},
    {"offset": {"line": 1076, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/editor/plugins/SlashCommandPlugin.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useEffect, useMemo, useState, useRef } from \"react\";\nimport { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport {\n  $createParagraphNode,\n  $getSelection,\n  $isRangeSelection,\n  COMMAND_PRIORITY_LOW,\n  KEY_ARROW_DOWN_COMMAND,\n  KEY_ARROW_UP_COMMAND,\n  KEY_ENTER_COMMAND,\n  KEY_ESCAPE_COMMAND,\n  KEY_TAB_COMMAND,\n  TextNode,\n} from \"lexical\";\nimport { $setBlocksType } from \"@lexical/selection\";\nimport { $createHeadingNode, $createQuoteNode } from \"@lexical/rich-text\";\nimport { INSERT_ORDERED_LIST_COMMAND, INSERT_UNORDERED_LIST_COMMAND } from \"@lexical/list\";\nimport { mergeRegister } from \"@lexical/utils\";\nimport { createPortal } from \"react-dom\";\nimport {\n  Heading1,\n  Heading2,\n  Heading3,\n  List,\n  ListOrdered,\n  Quote,\n  ImagePlus,\n  FileUp,\n} from \"lucide-react\";\nimport { $createAttachmentNode, type AttachmentType } from \"../nodes/AttachmentNode\";\nimport { api } from \"~/lib/trpc/client\";\n\ninterface CommandOption {\n  name: string;\n  command: string;\n  icon: React.ReactNode;\n  description: string;\n}\n\nconst COMMANDS: CommandOption[] = [\n  {\n    name: \"Heading 1\",\n    command: \"heading1\",\n    icon: <Heading1 className=\"h-4 w-4\" />,\n    description: \"Large section heading\",\n  },\n  {\n    name: \"Heading 2\",\n    command: \"heading2\",\n    icon: <Heading2 className=\"h-4 w-4\" />,\n    description: \"Medium section heading\",\n  },\n  {\n    name: \"Heading 3\",\n    command: \"heading3\",\n    icon: <Heading3 className=\"h-4 w-4\" />,\n    description: \"Small section heading\",\n  },\n  {\n    name: \"Bullet List\",\n    command: \"bulletList\",\n    icon: <List className=\"h-4 w-4\" />,\n    description: \"Create a bullet list\",\n  },\n  {\n    name: \"Numbered List\",\n    command: \"numberedList\",\n    icon: <ListOrdered className=\"h-4 w-4\" />,\n    description: \"Create a numbered list\",\n  },\n  {\n    name: \"Quote\",\n    command: \"quote\",\n    icon: <Quote className=\"h-4 w-4\" />,\n    description: \"Add a block quote\",\n  },\n  {\n    name: \"Image\",\n    command: \"image\",\n    icon: <ImagePlus className=\"h-4 w-4\" />,\n    description: \"Upload an image\",\n  },\n  {\n    name: \"File\",\n    command: \"file\",\n    icon: <FileUp className=\"h-4 w-4\" />,\n    description: \"Upload any file\",\n  },\n];\n\ninterface SlashCommandPluginProps {\n  anchorElem: HTMLElement;\n}\n\nexport function SlashCommandPlugin({ anchorElem }: SlashCommandPluginProps) {\n  const [editor] = useLexicalComposerContext();\n  const [isOpen, setIsOpen] = useState(false);\n  const [query, setQuery] = useState(\"\");\n  const [selectedIndex, setSelectedIndex] = useState(0);\n  const [position, setPosition] = useState({ top: 0, left: 0 });\n  const menuRef = useRef<HTMLDivElement>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const uploadMutation = api.upload.getUploadUrl.useMutation();\n  const pendingCommandRef = useRef<string | null>(null);\n\n  const filteredCommands = useMemo(() => {\n    if (!query) return COMMANDS;\n    const lowerQuery = query.toLowerCase();\n    return COMMANDS.filter(\n      (cmd) =>\n        cmd.name.toLowerCase().includes(lowerQuery) ||\n        cmd.description.toLowerCase().includes(lowerQuery) ||\n        cmd.command.toLowerCase().includes(lowerQuery)\n    );\n  }, [query]);\n\n  // Reset selected index when filtered commands change\n  useEffect(() => {\n    setSelectedIndex(0);\n  }, [filteredCommands.length]);\n\n  const handleFileUpload = useCallback(\n    async (file: File) => {\n      try {\n        const result = await uploadMutation.mutateAsync({\n          filename: file.name,\n          contentType: file.type,\n          size: file.size,\n        });\n\n        const uploadResponse = await fetch(result.uploadUrl, {\n          method: \"PUT\",\n          body: file,\n          headers: {\n            \"Content-Type\": file.type,\n          },\n        });\n\n        if (!uploadResponse.ok) {\n          const errorText = await uploadResponse.text();\n          console.error(\"R2 upload failed:\", uploadResponse.status, errorText);\n          alert(`Upload failed: ${uploadResponse.status} - ${errorText || \"Unknown error\"}`);\n          return;\n        }\n\n        let attachmentType: AttachmentType = \"FILE\";\n        if (file.type.startsWith(\"image/\")) {\n          attachmentType = \"IMAGE\";\n        } else if (file.type.startsWith(\"video/\")) {\n          attachmentType = \"VIDEO\";\n        }\n\n        editor.update(() => {\n          const selection = $getSelection();\n          if ($isRangeSelection(selection)) {\n            const attachmentNode = $createAttachmentNode({\n              attachmentType,\n              url: result.publicUrl,\n              filename: file.name,\n              mimeType: file.type,\n              size: file.size,\n            });\n            selection.insertNodes([attachmentNode, $createParagraphNode()]);\n          }\n        });\n      } catch (error) {\n        console.error(\"Upload failed:\", error);\n        alert(`Upload failed: ${error instanceof Error ? error.message : \"Unknown error\"}`);\n      }\n    },\n    [editor, uploadMutation]\n  );\n\n  const executeCommand = useCallback(\n    (command: string) => {\n      editor.update(() => {\n        const selection = $getSelection();\n        if (!$isRangeSelection(selection)) return;\n\n        // Remove the slash and query text\n        const anchor = selection.anchor;\n        const anchorNode = anchor.getNode();\n        if (anchorNode instanceof TextNode) {\n          const textContent = anchorNode.getTextContent();\n          const slashIndex = textContent.lastIndexOf(\"/\");\n          if (slashIndex !== -1) {\n            const newText = textContent.slice(0, slashIndex);\n            if (newText) {\n              anchorNode.setTextContent(newText);\n              selection.setTextNodeRange(anchorNode, newText.length, anchorNode, newText.length);\n            } else {\n              anchorNode.remove();\n            }\n          }\n        }\n\n        switch (command) {\n          case \"heading1\":\n            $setBlocksType(selection, () => $createHeadingNode(\"h1\"));\n            break;\n          case \"heading2\":\n            $setBlocksType(selection, () => $createHeadingNode(\"h2\"));\n            break;\n          case \"heading3\":\n            $setBlocksType(selection, () => $createHeadingNode(\"h3\"));\n            break;\n          case \"bulletList\":\n            editor.dispatchCommand(INSERT_UNORDERED_LIST_COMMAND, undefined);\n            break;\n          case \"numberedList\":\n            editor.dispatchCommand(INSERT_ORDERED_LIST_COMMAND, undefined);\n            break;\n          case \"quote\":\n            $setBlocksType(selection, () => $createQuoteNode());\n            break;\n          case \"image\":\n          case \"file\":\n            pendingCommandRef.current = command;\n            setTimeout(() => {\n              if (fileInputRef.current) {\n                fileInputRef.current.accept = command === \"image\" ? \"image/*,video/*\" : \"*/*\";\n                fileInputRef.current.click();\n              }\n            }, 0);\n            break;\n        }\n      });\n\n      setIsOpen(false);\n      setQuery(\"\");\n    },\n    [editor]\n  );\n\n  // Listen for text changes to detect slash commands\n  useEffect(() => {\n    return editor.registerTextContentListener((text) => {\n      editor.getEditorState().read(() => {\n        const selection = $getSelection();\n        if (!$isRangeSelection(selection)) {\n          setIsOpen(false);\n          return;\n        }\n\n        const anchor = selection.anchor;\n        const anchorNode = anchor.getNode();\n\n        if (!(anchorNode instanceof TextNode)) {\n          setIsOpen(false);\n          return;\n        }\n\n        const textContent = anchorNode.getTextContent();\n        const anchorOffset = anchor.offset;\n        const textBeforeCursor = textContent.slice(0, anchorOffset);\n\n        // Find the last slash in the text before cursor\n        const slashIndex = textBeforeCursor.lastIndexOf(\"/\");\n\n        if (slashIndex === -1) {\n          setIsOpen(false);\n          return;\n        }\n\n        // Check if slash is at start of line or preceded by whitespace\n        const charBeforeSlash = textBeforeCursor[slashIndex - 1];\n        if (slashIndex > 0 && charBeforeSlash !== \" \" && charBeforeSlash !== \"\\n\") {\n          setIsOpen(false);\n          return;\n        }\n\n        // Extract query after slash\n        const queryText = textBeforeCursor.slice(slashIndex + 1);\n\n        // Don't show menu if there's a space in the query (command ended)\n        if (queryText.includes(\" \")) {\n          setIsOpen(false);\n          return;\n        }\n\n        setQuery(queryText);\n        setIsOpen(true);\n\n        // Get position for menu\n        const domSelection = window.getSelection();\n        if (domSelection && domSelection.rangeCount > 0) {\n          const range = domSelection.getRangeAt(0);\n          const rect = range.getBoundingClientRect();\n          const editorRect = anchorElem.getBoundingClientRect();\n\n          setPosition({\n            top: rect.bottom - editorRect.top + 4,\n            left: rect.left - editorRect.left,\n          });\n        }\n      });\n    });\n  }, [editor, anchorElem]);\n\n  // Handle keyboard navigation\n  useEffect(() => {\n    if (!isOpen) return;\n\n    return mergeRegister(\n      editor.registerCommand(\n        KEY_ARROW_DOWN_COMMAND,\n        (event) => {\n          event.preventDefault();\n          setSelectedIndex((prev) =>\n            prev < filteredCommands.length - 1 ? prev + 1 : 0\n          );\n          return true;\n        },\n        COMMAND_PRIORITY_LOW\n      ),\n      editor.registerCommand(\n        KEY_ARROW_UP_COMMAND,\n        (event) => {\n          event.preventDefault();\n          setSelectedIndex((prev) =>\n            prev > 0 ? prev - 1 : filteredCommands.length - 1\n          );\n          return true;\n        },\n        COMMAND_PRIORITY_LOW\n      ),\n      editor.registerCommand(\n        KEY_ENTER_COMMAND,\n        (event) => {\n          if (filteredCommands[selectedIndex]) {\n            event?.preventDefault();\n            executeCommand(filteredCommands[selectedIndex].command);\n            return true;\n          }\n          return false;\n        },\n        COMMAND_PRIORITY_LOW\n      ),\n      editor.registerCommand(\n        KEY_TAB_COMMAND,\n        (event) => {\n          if (filteredCommands[selectedIndex]) {\n            event.preventDefault();\n            executeCommand(filteredCommands[selectedIndex].command);\n            return true;\n          }\n          return false;\n        },\n        COMMAND_PRIORITY_LOW\n      ),\n      editor.registerCommand(\n        KEY_ESCAPE_COMMAND,\n        () => {\n          setIsOpen(false);\n          setQuery(\"\");\n          return true;\n        },\n        COMMAND_PRIORITY_LOW\n      )\n    );\n  }, [editor, isOpen, filteredCommands, selectedIndex, executeCommand]);\n\n  // Click outside to close\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleClickOutside = (event: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n        setQuery(\"\");\n      }\n    };\n\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\n  }, [isOpen]);\n\n  return (\n    <>\n      <input\n        ref={fileInputRef}\n        type=\"file\"\n        className=\"hidden\"\n        onChange={(e) => {\n          const file = e.target.files?.[0];\n          if (file) {\n            handleFileUpload(file);\n          }\n          e.target.value = \"\";\n          pendingCommandRef.current = null;\n        }}\n      />\n      {isOpen && filteredCommands.length > 0 && createPortal(\n        <div\n          ref={menuRef}\n          className=\"absolute z-50 min-w-[280px] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md\"\n          style={{ top: position.top, left: position.left }}\n        >\n          <ul role=\"listbox\">\n            {filteredCommands.map((option, index) => (\n              <li\n                key={option.command}\n                role=\"option\"\n                aria-selected={selectedIndex === index}\n                onClick={() => executeCommand(option.command)}\n                onMouseEnter={() => setSelectedIndex(index)}\n                className={`flex cursor-pointer items-center gap-3 rounded-md px-2 py-2 text-sm ${\n                  selectedIndex === index ? \"bg-accent text-accent-foreground\" : \"\"\n                }`}\n              >\n                <div className=\"flex h-8 w-8 items-center justify-center rounded-md border bg-background\">\n                  {option.icon}\n                </div>\n                <div>\n                  <p className=\"font-medium\">{option.name}</p>\n                  <p className=\"text-xs text-muted-foreground\">{option.description}</p>\n                </div>\n              </li>\n            ))}\n          </ul>\n        </div>,\n        anchorElem\n      )}\n    </>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1606, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/editor/plugins/DragDropPlugin.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useEffect } from \"react\";\nimport { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport {\n  $getSelection,\n  $isRangeSelection,\n  $createParagraphNode,\n  COMMAND_PRIORITY_HIGH,\n  DROP_COMMAND,\n  DRAGOVER_COMMAND,\n} from \"lexical\";\nimport { $createAttachmentNode, type AttachmentType } from \"../nodes/AttachmentNode\";\nimport { api } from \"~/lib/trpc/client\";\n\nexport function DragDropPlugin() {\n  const [editor] = useLexicalComposerContext();\n  const uploadMutation = api.upload.getUploadUrl.useMutation();\n\n  const handleDrop = useCallback(\n    async (event: DragEvent) => {\n      const files = event.dataTransfer?.files;\n      if (!files || files.length === 0) return false;\n\n      event.preventDefault();\n\n      for (const file of Array.from(files)) {\n        try {\n          const result = await uploadMutation.mutateAsync({\n            filename: file.name,\n            contentType: file.type,\n            size: file.size,\n          });\n\n          // Upload to R2\n          await fetch(result.uploadUrl, {\n            method: \"PUT\",\n            body: file,\n            headers: {\n              \"Content-Type\": file.type,\n            },\n          });\n\n          // Determine attachment type\n          let attachmentType: AttachmentType = \"FILE\";\n          if (file.type.startsWith(\"image/\")) {\n            attachmentType = \"IMAGE\";\n          } else if (file.type.startsWith(\"video/\")) {\n            attachmentType = \"VIDEO\";\n          }\n\n          // Insert attachment node\n          editor.update(() => {\n            const selection = $getSelection();\n            if ($isRangeSelection(selection)) {\n              const attachmentNode = $createAttachmentNode({\n                attachmentType,\n                url: result.publicUrl,\n                filename: file.name,\n                mimeType: file.type,\n                size: file.size,\n              });\n              selection.insertNodes([attachmentNode, $createParagraphNode()]);\n            }\n          });\n        } catch (error) {\n          console.error(\"Upload failed:\", error);\n        }\n      }\n\n      return true;\n    },\n    [editor, uploadMutation]\n  );\n\n  useEffect(() => {\n    return editor.registerCommand(\n      DRAGOVER_COMMAND,\n      (event) => {\n        event.preventDefault();\n        return true;\n      },\n      COMMAND_PRIORITY_HIGH\n    );\n  }, [editor]);\n\n  useEffect(() => {\n    return editor.registerCommand(\n      DROP_COMMAND,\n      (event) => {\n        handleDrop(event);\n        return true;\n      },\n      COMMAND_PRIORITY_HIGH\n    );\n  }, [editor, handleDrop]);\n\n  return null;\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAQA;AACA;;AAbA;;;;;;AAeO,SAAS;;IACd,MAAM,CAAC,OAAO,GAAG,IAAA,oMAAyB;IAC1C,MAAM,iBAAiB,sIAAG,CAAC,MAAM,CAAC,YAAY,CAAC,WAAW;IAE1D,MAAM,aAAa,IAAA,4KAAW;kDAC5B,OAAO;gBACS;YAAd,MAAM,SAAQ,sBAAA,MAAM,YAAY,cAAlB,0CAAA,oBAAoB,KAAK;YACvC,IAAI,CAAC,SAAS,MAAM,MAAM,KAAK,GAAG,OAAO;YAEzC,MAAM,cAAc;YAEpB,KAAK,MAAM,QAAQ,MAAM,IAAI,CAAC,OAAQ;gBACpC,IAAI;oBACF,MAAM,SAAS,MAAM,eAAe,WAAW,CAAC;wBAC9C,UAAU,KAAK,IAAI;wBACnB,aAAa,KAAK,IAAI;wBACtB,MAAM,KAAK,IAAI;oBACjB;oBAEA,eAAe;oBACf,MAAM,MAAM,OAAO,SAAS,EAAE;wBAC5B,QAAQ;wBACR,MAAM;wBACN,SAAS;4BACP,gBAAgB,KAAK,IAAI;wBAC3B;oBACF;oBAEA,4BAA4B;oBAC5B,IAAI,iBAAiC;oBACrC,IAAI,KAAK,IAAI,CAAC,UAAU,CAAC,WAAW;wBAClC,iBAAiB;oBACnB,OAAO,IAAI,KAAK,IAAI,CAAC,UAAU,CAAC,WAAW;wBACzC,iBAAiB;oBACnB;oBAEA,yBAAyB;oBACzB,OAAO,MAAM;kEAAC;4BACZ,MAAM,YAAY,IAAA,8JAAa;4BAC/B,IAAI,IAAA,kKAAiB,EAAC,YAAY;gCAChC,MAAM,iBAAiB,IAAA,mLAAqB,EAAC;oCAC3C;oCACA,KAAK,OAAO,SAAS;oCACrB,UAAU,KAAK,IAAI;oCACnB,UAAU,KAAK,IAAI;oCACnB,MAAM,KAAK,IAAI;gCACjB;gCACA,UAAU,WAAW,CAAC;oCAAC;oCAAgB,IAAA,qKAAoB;iCAAG;4BAChE;wBACF;;gBACF,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,kBAAkB;gBAClC;YACF;YAEA,OAAO;QACT;iDACA;QAAC;QAAQ;KAAe;IAG1B,IAAA,0KAAS;oCAAC;YACR,OAAO,OAAO,eAAe,CAC3B,iKAAgB;4CAChB,CAAC;oBACC,MAAM,cAAc;oBACpB,OAAO;gBACT;2CACA,sKAAqB;QAEzB;mCAAG;QAAC;KAAO;IAEX,IAAA,0KAAS;oCAAC;YACR,OAAO,OAAO,eAAe,CAC3B,6JAAY;4CACZ,CAAC;oBACC,WAAW;oBACX,OAAO;gBACT;2CACA,sKAAqB;QAEzB;mCAAG;QAAC;QAAQ;KAAW;IAEvB,OAAO;AACT;GAnFgB;;QACG,oMAAyB;;;KAD5B","debugId":null}},
    {"offset": {"line": 1725, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/editor/plugins/FloatingAddButtonPlugin.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport {\n  $getSelection,\n  $isRangeSelection,\n  $createParagraphNode,\n  $getNodeByKey,\n  $isParagraphNode,\n  COMMAND_PRIORITY_LOW,\n  KEY_ARROW_DOWN_COMMAND,\n  KEY_ARROW_UP_COMMAND,\n} from \"lexical\";\nimport { createPortal } from \"react-dom\";\nimport {\n  Plus,\n  ImagePlus,\n  FileUp,\n  Heading1,\n  Heading2,\n  List,\n  ListOrdered,\n  Quote,\n  X,\n} from \"lucide-react\";\nimport { $createAttachmentNode, type AttachmentType } from \"../nodes/AttachmentNode\";\nimport { $setBlocksType } from \"@lexical/selection\";\nimport { $createHeadingNode, $createQuoteNode } from \"@lexical/rich-text\";\nimport { INSERT_ORDERED_LIST_COMMAND, INSERT_UNORDERED_LIST_COMMAND } from \"@lexical/list\";\nimport { api } from \"~/lib/trpc/client\";\nimport { cn } from \"~/lib/utils\";\n\ninterface FloatingAddButtonPluginProps {\n  anchorElem: HTMLElement;\n}\n\nexport function FloatingAddButtonPlugin({ anchorElem }: FloatingAddButtonPluginProps) {\n  const [editor] = useLexicalComposerContext();\n  const [isVisible, setIsVisible] = useState(false);\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\n  const [position, setPosition] = useState({ top: 0 });\n  const [isEmpty, setIsEmpty] = useState(false);\n  const buttonRef = useRef<HTMLDivElement>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const uploadMutation = api.upload.getUploadUrl.useMutation();\n\n  const updatePosition = useCallback(() => {\n    editor.getEditorState().read(() => {\n      const selection = $getSelection();\n      if (!$isRangeSelection(selection)) {\n        setIsVisible(false);\n        return;\n      }\n\n      const anchor = selection.anchor;\n      const anchorNode = anchor.getNode();\n      const topLevelElement = anchorNode.getTopLevelElement();\n\n      if (!topLevelElement) {\n        setIsVisible(false);\n        return;\n      }\n\n      // Check if the current block is empty (only for paragraphs)\n      const isEmptyParagraph = $isParagraphNode(topLevelElement) &&\n        topLevelElement.getTextContent().trim() === \"\";\n\n      setIsEmpty(isEmptyParagraph);\n\n      const key = topLevelElement.getKey();\n      const elem = editor.getElementByKey(key);\n\n      if (!elem) {\n        setIsVisible(false);\n        return;\n      }\n\n      const editorRect = anchorElem.getBoundingClientRect();\n      const elemRect = elem.getBoundingClientRect();\n\n      setPosition({\n        top: elemRect.top - editorRect.top + 4,\n      });\n      setIsVisible(true);\n    });\n  }, [editor, anchorElem]);\n\n  useEffect(() => {\n    return editor.registerUpdateListener(({ editorState }) => {\n      editorState.read(() => {\n        updatePosition();\n      });\n    });\n  }, [editor, updatePosition]);\n\n  // Close menu when clicking outside\n  useEffect(() => {\n    if (!isMenuOpen) return;\n\n    const handleClickOutside = (e: MouseEvent) => {\n      if (buttonRef.current && !buttonRef.current.contains(e.target as Node)) {\n        setIsMenuOpen(false);\n      }\n    };\n\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\n  }, [isMenuOpen]);\n\n  const handleFileUpload = useCallback(\n    async (file: File) => {\n      setIsMenuOpen(false);\n      try {\n        const result = await uploadMutation.mutateAsync({\n          filename: file.name,\n          contentType: file.type,\n          size: file.size,\n        });\n\n        // Upload to R2\n        const uploadResponse = await fetch(result.uploadUrl, {\n          method: \"PUT\",\n          body: file,\n          headers: {\n            \"Content-Type\": file.type,\n          },\n        });\n\n        if (!uploadResponse.ok) {\n          const errorText = await uploadResponse.text();\n          console.error(\"R2 upload failed:\", uploadResponse.status, errorText);\n          alert(`Upload failed: ${uploadResponse.status} - Check CORS configuration on R2 bucket`);\n          return;\n        }\n\n        // Determine attachment type\n        let attachmentType: AttachmentType = \"FILE\";\n        if (file.type.startsWith(\"image/\")) {\n          attachmentType = \"IMAGE\";\n        } else if (file.type.startsWith(\"video/\")) {\n          attachmentType = \"VIDEO\";\n        }\n\n        // Insert attachment node\n        editor.update(() => {\n          const selection = $getSelection();\n          if ($isRangeSelection(selection)) {\n            const attachmentNode = $createAttachmentNode({\n              attachmentType,\n              url: result.publicUrl,\n              filename: file.name,\n              mimeType: file.type,\n              size: file.size,\n            });\n            selection.insertNodes([attachmentNode, $createParagraphNode()]);\n          }\n        });\n      } catch (error) {\n        console.error(\"Upload failed:\", error);\n        const message = error instanceof Error ? error.message : \"Unknown error\";\n        alert(`Upload failed: ${message}`);\n      }\n    },\n    [editor, uploadMutation]\n  );\n\n  const triggerFileInput = (accept: string) => {\n    if (fileInputRef.current) {\n      fileInputRef.current.accept = accept;\n      fileInputRef.current.click();\n    }\n  };\n\n  const insertBlock = (type: string) => {\n    setIsMenuOpen(false);\n    editor.update(() => {\n      const selection = $getSelection();\n      if (!$isRangeSelection(selection)) return;\n\n      switch (type) {\n        case \"h1\":\n          $setBlocksType(selection, () => $createHeadingNode(\"h1\"));\n          break;\n        case \"h2\":\n          $setBlocksType(selection, () => $createHeadingNode(\"h2\"));\n          break;\n        case \"bulletList\":\n          editor.dispatchCommand(INSERT_UNORDERED_LIST_COMMAND, undefined);\n          break;\n        case \"numberedList\":\n          editor.dispatchCommand(INSERT_ORDERED_LIST_COMMAND, undefined);\n          break;\n        case \"quote\":\n          $setBlocksType(selection, () => $createQuoteNode());\n          break;\n      }\n    });\n  };\n\n  if (!isVisible) return null;\n\n  return createPortal(\n    <div\n      ref={buttonRef}\n      className=\"absolute -left-8 z-10 transition-opacity\"\n      style={{ top: position.top }}\n    >\n      <input\n        ref={fileInputRef}\n        type=\"file\"\n        className=\"hidden\"\n        onChange={(e) => {\n          const file = e.target.files?.[0];\n          if (file) {\n            handleFileUpload(file);\n          }\n          e.target.value = \"\";\n        }}\n      />\n\n      <button\n        type=\"button\"\n        onClick={() => setIsMenuOpen(!isMenuOpen)}\n        className={cn(\n          \"flex h-6 w-6 items-center justify-center rounded-full border bg-background text-muted-foreground transition-all hover:bg-muted hover:text-foreground\",\n          isMenuOpen && \"rotate-45 bg-muted text-foreground\",\n          !isEmpty && \"opacity-0 hover:opacity-100\"\n        )}\n      >\n        <Plus className=\"h-4 w-4\" />\n      </button>\n\n      {isMenuOpen && (\n        <div className=\"absolute left-0 top-8 z-50 min-w-[200px] overflow-hidden rounded-lg border bg-popover p-1 shadow-lg animate-in fade-in-0 zoom-in-95\">\n          <p className=\"px-2 py-1 text-xs font-medium text-muted-foreground\">\n            Add blocks\n          </p>\n          <button\n            onClick={() => triggerFileInput(\"image/*\")}\n            className=\"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted\"\n          >\n            <div className=\"flex h-7 w-7 items-center justify-center rounded-md border bg-background\">\n              <ImagePlus className=\"h-4 w-4\" />\n            </div>\n            <div className=\"text-left\">\n              <p className=\"font-medium\">Image</p>\n              <p className=\"text-xs text-muted-foreground\">Upload an image</p>\n            </div>\n          </button>\n          <button\n            onClick={() => triggerFileInput(\"*/*\")}\n            className=\"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted\"\n          >\n            <div className=\"flex h-7 w-7 items-center justify-center rounded-md border bg-background\">\n              <FileUp className=\"h-4 w-4\" />\n            </div>\n            <div className=\"text-left\">\n              <p className=\"font-medium\">File</p>\n              <p className=\"text-xs text-muted-foreground\">Upload any file</p>\n            </div>\n          </button>\n          <div className=\"my-1 h-px bg-border\" />\n          <button\n            onClick={() => insertBlock(\"h1\")}\n            className=\"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted\"\n          >\n            <div className=\"flex h-7 w-7 items-center justify-center rounded-md border bg-background\">\n              <Heading1 className=\"h-4 w-4\" />\n            </div>\n            <span>Heading 1</span>\n          </button>\n          <button\n            onClick={() => insertBlock(\"h2\")}\n            className=\"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted\"\n          >\n            <div className=\"flex h-7 w-7 items-center justify-center rounded-md border bg-background\">\n              <Heading2 className=\"h-4 w-4\" />\n            </div>\n            <span>Heading 2</span>\n          </button>\n          <button\n            onClick={() => insertBlock(\"bulletList\")}\n            className=\"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted\"\n          >\n            <div className=\"flex h-7 w-7 items-center justify-center rounded-md border bg-background\">\n              <List className=\"h-4 w-4\" />\n            </div>\n            <span>Bullet List</span>\n          </button>\n          <button\n            onClick={() => insertBlock(\"numberedList\")}\n            className=\"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted\"\n          >\n            <div className=\"flex h-7 w-7 items-center justify-center rounded-md border bg-background\">\n              <ListOrdered className=\"h-4 w-4\" />\n            </div>\n            <span>Numbered List</span>\n          </button>\n          <button\n            onClick={() => insertBlock(\"quote\")}\n            className=\"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted\"\n          >\n            <div className=\"flex h-7 w-7 items-center justify-center rounded-md border bg-background\">\n              <Quote className=\"h-4 w-4\" />\n            </div>\n            <span>Quote</span>\n          </button>\n        </div>\n      )}\n    </div>,\n    anchorElem\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2278, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/editor/plugins/NodeDeletionPlugin.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect } from \"react\";\nimport { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport {\n  $getSelection,\n  $isNodeSelection,\n  COMMAND_PRIORITY_LOW,\n  KEY_BACKSPACE_COMMAND,\n  KEY_DELETE_COMMAND,\n} from \"lexical\";\n\nexport function NodeDeletionPlugin() {\n  const [editor] = useLexicalComposerContext();\n\n  useEffect(() => {\n    const removeBackspace = editor.registerCommand(\n      KEY_BACKSPACE_COMMAND,\n      () => {\n        const selection = $getSelection();\n        if ($isNodeSelection(selection)) {\n          const nodes = selection.getNodes();\n          nodes.forEach((node) => {\n            node.remove();\n          });\n          return true;\n        }\n        return false;\n      },\n      COMMAND_PRIORITY_LOW\n    );\n\n    const removeDelete = editor.registerCommand(\n      KEY_DELETE_COMMAND,\n      () => {\n        const selection = $getSelection();\n        if ($isNodeSelection(selection)) {\n          const nodes = selection.getNodes();\n          nodes.forEach((node) => {\n            node.remove();\n          });\n          return true;\n        }\n        return false;\n      },\n      COMMAND_PRIORITY_LOW\n    );\n\n    return () => {\n      removeBackspace();\n      removeDelete();\n    };\n  }, [editor]);\n\n  return null;\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;AAJA;;;;AAYO,SAAS;;IACd,MAAM,CAAC,OAAO,GAAG,IAAA,oMAAyB;IAE1C,IAAA,0KAAS;wCAAC;YACR,MAAM,kBAAkB,OAAO,eAAe,CAC5C,sKAAqB;gEACrB;oBACE,MAAM,YAAY,IAAA,8JAAa;oBAC/B,IAAI,IAAA,iKAAgB,EAAC,YAAY;wBAC/B,MAAM,QAAQ,UAAU,QAAQ;wBAChC,MAAM,OAAO;4EAAC,CAAC;gCACb,KAAK,MAAM;4BACb;;wBACA,OAAO;oBACT;oBACA,OAAO;gBACT;+DACA,qKAAoB;YAGtB,MAAM,eAAe,OAAO,eAAe,CACzC,mKAAkB;6DAClB;oBACE,MAAM,YAAY,IAAA,8JAAa;oBAC/B,IAAI,IAAA,iKAAgB,EAAC,YAAY;wBAC/B,MAAM,QAAQ,UAAU,QAAQ;wBAChC,MAAM,OAAO;yEAAC,CAAC;gCACb,KAAK,MAAM;4BACb;;wBACA,OAAO;oBACT;oBACA,OAAO;gBACT;4DACA,qKAAoB;YAGtB;gDAAO;oBACL;oBACA;gBACF;;QACF;uCAAG;QAAC;KAAO;IAEX,OAAO;AACT;GA3CgB;;QACG,oMAAyB;;;KAD5B","debugId":null}},
    {"offset": {"line": 2352, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/editor/toolbar/ToolbarPlugin.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useEffect, useState, useRef } from \"react\";\nimport { useLexicalComposerContext } from \"@lexical/react/LexicalComposerContext\";\nimport {\n  $getSelection,\n  $isRangeSelection,\n  $createParagraphNode,\n  FORMAT_TEXT_COMMAND,\n  SELECTION_CHANGE_COMMAND,\n  COMMAND_PRIORITY_CRITICAL,\n} from \"lexical\";\nimport { mergeRegister } from \"@lexical/utils\";\nimport { Button } from \"~/components/ui/button\";\nimport {\n  Bold,\n  Italic,\n  Underline,\n  Strikethrough,\n  Code,\n  ImagePlus,\n  Paperclip,\n} from \"lucide-react\";\nimport { cn } from \"~/lib/utils\";\nimport { $createAttachmentNode, type AttachmentType } from \"../nodes/AttachmentNode\";\nimport { api } from \"~/lib/trpc/client\";\n\nexport function ToolbarPlugin() {\n  const [editor] = useLexicalComposerContext();\n  const [isBold, setIsBold] = useState(false);\n  const [isItalic, setIsItalic] = useState(false);\n  const [isUnderline, setIsUnderline] = useState(false);\n  const [isStrikethrough, setIsStrikethrough] = useState(false);\n  const [isCode, setIsCode] = useState(false);\n  const [isUploading, setIsUploading] = useState(false);\n  const imageInputRef = useRef<HTMLInputElement>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const uploadMutation = api.upload.getUploadUrl.useMutation();\n\n  const updateToolbar = useCallback(() => {\n    const selection = $getSelection();\n    if ($isRangeSelection(selection)) {\n      setIsBold(selection.hasFormat(\"bold\"));\n      setIsItalic(selection.hasFormat(\"italic\"));\n      setIsUnderline(selection.hasFormat(\"underline\"));\n      setIsStrikethrough(selection.hasFormat(\"strikethrough\"));\n      setIsCode(selection.hasFormat(\"code\"));\n    }\n  }, []);\n\n  useEffect(() => {\n    return mergeRegister(\n      editor.registerUpdateListener(({ editorState }) => {\n        editorState.read(() => {\n          updateToolbar();\n        });\n      }),\n      editor.registerCommand(\n        SELECTION_CHANGE_COMMAND,\n        () => {\n          updateToolbar();\n          return false;\n        },\n        COMMAND_PRIORITY_CRITICAL\n      )\n    );\n  }, [editor, updateToolbar]);\n\n  const handleFileUpload = useCallback(\n    async (file: File) => {\n      setIsUploading(true);\n      try {\n        // Get presigned URL\n        const result = await uploadMutation.mutateAsync({\n          filename: file.name,\n          contentType: file.type,\n          size: file.size,\n        });\n\n        // Upload to R2\n        const uploadResponse = await fetch(result.uploadUrl, {\n          method: \"PUT\",\n          body: file,\n          headers: {\n            \"Content-Type\": file.type,\n          },\n        });\n\n        if (!uploadResponse.ok) {\n          const errorText = await uploadResponse.text();\n          console.error(\"R2 upload failed:\", uploadResponse.status, errorText);\n          alert(`Upload failed: ${uploadResponse.status} - Check CORS configuration on R2 bucket`);\n          return;\n        }\n\n        // Determine attachment type\n        let attachmentType: AttachmentType = \"FILE\";\n        if (file.type.startsWith(\"image/\")) {\n          attachmentType = \"IMAGE\";\n        } else if (file.type.startsWith(\"video/\")) {\n          attachmentType = \"VIDEO\";\n        }\n\n        // Insert attachment node\n        editor.update(() => {\n          const selection = $getSelection();\n          if ($isRangeSelection(selection)) {\n            const attachmentNode = $createAttachmentNode({\n              attachmentType,\n              url: result.publicUrl,\n              filename: file.name,\n              mimeType: file.type,\n              size: file.size,\n            });\n            selection.insertNodes([attachmentNode, $createParagraphNode()]);\n          }\n        });\n      } catch (error) {\n        console.error(\"Upload failed:\", error);\n        const message = error instanceof Error ? error.message : \"Unknown error\";\n        alert(`Upload failed: ${message}`);\n      } finally {\n        setIsUploading(false);\n      }\n    },\n    [editor, uploadMutation]\n  );\n\n  return (\n    <div className=\"relative z-20 flex items-center gap-0.5 border-b border-border px-2 py-1\">\n      {/* Hidden file inputs */}\n      <input\n        ref={imageInputRef}\n        type=\"file\"\n        accept=\"image/*,video/*\"\n        className=\"hidden\"\n        onChange={(e) => {\n          const file = e.target.files?.[0];\n          if (file) {\n            handleFileUpload(file);\n          }\n          e.target.value = \"\";\n        }}\n      />\n      <input\n        ref={fileInputRef}\n        type=\"file\"\n        accept=\"*/*\"\n        className=\"hidden\"\n        onChange={(e) => {\n          const file = e.target.files?.[0];\n          if (file) {\n            handleFileUpload(file);\n          }\n          e.target.value = \"\";\n        }}\n      />\n\n      {/* Text formatting buttons */}\n      <Button\n        type=\"button\"\n        variant=\"ghost\"\n        size=\"sm\"\n        className={cn(\"h-8 w-8 p-0\", isBold && \"bg-muted\")}\n        onClick={() => editor.dispatchCommand(FORMAT_TEXT_COMMAND, \"bold\")}\n        title=\"Bold (âB)\"\n      >\n        <Bold className=\"h-4 w-4\" />\n      </Button>\n      <Button\n        type=\"button\"\n        variant=\"ghost\"\n        size=\"sm\"\n        className={cn(\"h-8 w-8 p-0\", isItalic && \"bg-muted\")}\n        onClick={() => editor.dispatchCommand(FORMAT_TEXT_COMMAND, \"italic\")}\n        title=\"Italic (âI)\"\n      >\n        <Italic className=\"h-4 w-4\" />\n      </Button>\n      <Button\n        type=\"button\"\n        variant=\"ghost\"\n        size=\"sm\"\n        className={cn(\"h-8 w-8 p-0\", isUnderline && \"bg-muted\")}\n        onClick={() => editor.dispatchCommand(FORMAT_TEXT_COMMAND, \"underline\")}\n        title=\"Underline (âU)\"\n      >\n        <Underline className=\"h-4 w-4\" />\n      </Button>\n      <Button\n        type=\"button\"\n        variant=\"ghost\"\n        size=\"sm\"\n        className={cn(\"h-8 w-8 p-0\", isStrikethrough && \"bg-muted\")}\n        onClick={() => editor.dispatchCommand(FORMAT_TEXT_COMMAND, \"strikethrough\")}\n        title=\"Strikethrough\"\n      >\n        <Strikethrough className=\"h-4 w-4\" />\n      </Button>\n      <div className=\"mx-1 h-4 w-px bg-border\" />\n      <Button\n        type=\"button\"\n        variant=\"ghost\"\n        size=\"sm\"\n        className={cn(\"h-8 w-8 p-0\", isCode && \"bg-muted\")}\n        onClick={() => editor.dispatchCommand(FORMAT_TEXT_COMMAND, \"code\")}\n        title=\"Inline Code\"\n      >\n        <Code className=\"h-4 w-4\" />\n      </Button>\n\n      <div className=\"mx-1 h-4 w-px bg-border\" />\n\n      {/* Direct attachment buttons */}\n      <Button\n        type=\"button\"\n        variant=\"ghost\"\n        size=\"sm\"\n        className=\"h-8 gap-1.5 px-2\"\n        disabled={isUploading}\n        onClick={() => imageInputRef.current?.click()}\n        title=\"Add image or video\"\n      >\n        <ImagePlus className=\"h-4 w-4\" />\n        <span className=\"text-xs\">Image</span>\n      </Button>\n      <Button\n        type=\"button\"\n        variant=\"ghost\"\n        size=\"sm\"\n        className=\"h-8 gap-1.5 px-2\"\n        disabled={isUploading}\n        onClick={() => fileInputRef.current?.click()}\n        title=\"Add file\"\n      >\n        <Paperclip className=\"h-4 w-4\" />\n        <span className=\"text-xs\">File</span>\n      </Button>\n\n      {isUploading && (\n        <span className=\"ml-2 text-xs text-muted-foreground\">Uploading...</span>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2736, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/editor/Editor.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useState } from \"react\";\nimport {\n  LexicalComposer,\n  type InitialConfigType,\n} from \"@lexical/react/LexicalComposer\";\nimport { RichTextPlugin } from \"@lexical/react/LexicalRichTextPlugin\";\nimport { ContentEditable } from \"@lexical/react/LexicalContentEditable\";\nimport { HistoryPlugin } from \"@lexical/react/LexicalHistoryPlugin\";\nimport { OnChangePlugin } from \"@lexical/react/LexicalOnChangePlugin\";\nimport { LexicalErrorBoundary } from \"@lexical/react/LexicalErrorBoundary\";\nimport { MarkdownShortcutPlugin } from \"@lexical/react/LexicalMarkdownShortcutPlugin\";\nimport { ListPlugin } from \"@lexical/react/LexicalListPlugin\";\nimport { LinkPlugin } from \"@lexical/react/LexicalLinkPlugin\";\nimport { HeadingNode, QuoteNode } from \"@lexical/rich-text\";\nimport { ListItemNode, ListNode } from \"@lexical/list\";\nimport { LinkNode, AutoLinkNode } from \"@lexical/link\";\nimport { CodeNode, CodeHighlightNode } from \"@lexical/code\";\nimport { TRANSFORMERS } from \"@lexical/markdown\";\nimport type { EditorState, SerializedEditorState } from \"lexical\";\n\nimport { MentionNode } from \"./nodes/MentionNode\";\nimport { ImageNode } from \"./nodes/ImageNode\";\nimport { AttachmentNode } from \"./nodes/AttachmentNode\";\nimport { MentionPlugin } from \"./plugins/MentionPlugin\";\nimport { SlashCommandPlugin } from \"./plugins/SlashCommandPlugin\";\nimport { DragDropPlugin } from \"./plugins/DragDropPlugin\";\nimport { FloatingAddButtonPlugin } from \"./plugins/FloatingAddButtonPlugin\";\nimport { NodeDeletionPlugin } from \"./plugins/NodeDeletionPlugin\";\nimport { ToolbarPlugin } from \"./toolbar/ToolbarPlugin\";\nimport { cn } from \"~/lib/utils\";\n\ninterface EditorProps {\n  initialContent?: SerializedEditorState | null;\n  onChange?: (editorState: SerializedEditorState) => void;\n  placeholder?: string;\n  editable?: boolean;\n  showToolbar?: boolean;\n  minHeight?: string;\n  className?: string;\n}\n\nconst theme = {\n  paragraph: \"mb-2\",\n  heading: {\n    h1: \"text-3xl font-bold mb-4 mt-6\",\n    h2: \"text-2xl font-bold mb-3 mt-5\",\n    h3: \"text-xl font-bold mb-2 mt-4\",\n  },\n  list: {\n    ul: \"list-disc ml-4 mb-2\",\n    ol: \"list-decimal ml-4 mb-2\",\n    listitem: \"mb-1\",\n  },\n  quote: \"border-l-4 border-primary/30 pl-4 italic text-muted-foreground my-4\",\n  code: \"font-mono bg-muted px-1.5 py-0.5 rounded text-sm\",\n  codeHighlight: {\n    atrule: \"text-purple-500\",\n    attr: \"text-yellow-500\",\n    boolean: \"text-purple-500\",\n    builtin: \"text-cyan-500\",\n    cdata: \"text-gray-500\",\n    char: \"text-green-500\",\n    class: \"text-yellow-500\",\n    \"class-name\": \"text-yellow-500\",\n    comment: \"text-gray-500\",\n    constant: \"text-purple-500\",\n    deleted: \"text-red-500\",\n    doctype: \"text-gray-500\",\n    entity: \"text-red-500\",\n    function: \"text-blue-500\",\n    important: \"text-purple-500\",\n    inserted: \"text-green-500\",\n    keyword: \"text-purple-500\",\n    namespace: \"text-purple-500\",\n    number: \"text-purple-500\",\n    operator: \"text-gray-500\",\n    prolog: \"text-gray-500\",\n    property: \"text-red-500\",\n    punctuation: \"text-gray-500\",\n    regex: \"text-green-500\",\n    selector: \"text-green-500\",\n    string: \"text-green-500\",\n    symbol: \"text-purple-500\",\n    tag: \"text-red-500\",\n    url: \"text-blue-500\",\n    variable: \"text-orange-500\",\n  },\n  link: \"text-primary underline cursor-pointer hover:text-primary/80\",\n  text: {\n    bold: \"font-bold\",\n    italic: \"italic\",\n    underline: \"underline\",\n    strikethrough: \"line-through\",\n    code: \"font-mono bg-muted px-1.5 py-0.5 rounded text-sm\",\n  },\n};\n\nexport function Editor({\n  initialContent,\n  onChange,\n  placeholder = \"Start writing, type / for commands or click + to add...\",\n  editable = true,\n  showToolbar = true,\n  minHeight = \"200px\",\n  className,\n}: EditorProps) {\n  const [floatingAnchorElem, setFloatingAnchorElem] =\n    useState<HTMLDivElement | null>(null);\n\n  const onRef = useCallback((elem: HTMLDivElement | null) => {\n    if (elem !== null) {\n      setFloatingAnchorElem(elem);\n    }\n  }, []);\n\n  const handleChange = useCallback(\n    (editorState: EditorState) => {\n      if (onChange) {\n        onChange(editorState.toJSON());\n      }\n    },\n    [onChange]\n  );\n\n  const initialConfig: InitialConfigType = {\n    namespace: \"DraftboardEditor\",\n    theme,\n    onError: (error: Error) => {\n      console.error(\"Lexical error:\", error);\n    },\n    nodes: [\n      HeadingNode,\n      QuoteNode,\n      ListNode,\n      ListItemNode,\n      LinkNode,\n      AutoLinkNode,\n      CodeNode,\n      CodeHighlightNode,\n      MentionNode,\n      ImageNode,\n      AttachmentNode,\n    ],\n    editorState: initialContent ? JSON.stringify(initialContent) : undefined,\n    editable,\n  };\n\n  return (\n    <LexicalComposer initialConfig={initialConfig}>\n      <div className={cn(\"editor-container relative\", className)}>\n        {showToolbar && editable && <ToolbarPlugin />}\n        <div className=\"relative\" ref={onRef}>\n          <RichTextPlugin\n            contentEditable={\n              <ContentEditable\n                className=\"editor-input outline-none\"\n                style={{ minHeight }}\n              />\n            }\n            placeholder={\n              <div className=\"editor-placeholder\">{placeholder}</div>\n            }\n            ErrorBoundary={LexicalErrorBoundary}\n          />\n        </div>\n        <HistoryPlugin />\n        <ListPlugin />\n        <LinkPlugin />\n        <MarkdownShortcutPlugin transformers={TRANSFORMERS} />\n        <OnChangePlugin onChange={handleChange} />\n        {editable && <MentionPlugin />}\n        {editable && <NodeDeletionPlugin />}\n        {editable && floatingAnchorElem && (\n          <>\n            <SlashCommandPlugin anchorElem={floatingAnchorElem} />\n            <DragDropPlugin />\n            <FloatingAddButtonPlugin anchorElem={floatingAnchorElem} />\n          </>\n        )}\n      </div>\n    </LexicalComposer>\n  );\n}\n\n// Read-only version for displaying content\nexport function EditorContent({\n  content,\n  className,\n}: {\n  content: SerializedEditorState;\n  className?: string;\n}) {\n  return (\n    <Editor\n      initialContent={content}\n      editable={false}\n      showToolbar={false}\n      minHeight=\"auto\"\n      className={className}\n    />\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3037, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/ui/popover.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\";\nimport { cn } from \"~/lib/utils\";\n\nconst Popover = PopoverPrimitive.Root;\n\nconst PopoverTrigger = PopoverPrimitive.Trigger;\n\nconst PopoverAnchor = PopoverPrimitive.Anchor;\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n));\nPopoverContent.displayName = PopoverPrimitive.Content.displayName;\n\nexport { Popover, PopoverTrigger, PopoverContent, PopoverAnchor };\n"],"names":[],"mappings":";;;;;;;;;;;AAEA;AACA;AACA;AAJA;;;;;AAMA,MAAM,UAAU,8KAAqB;AAErC,MAAM,iBAAiB,iLAAwB;AAE/C,MAAM,gBAAgB,gLAAuB;AAE7C,MAAM,+BAAiB,2KAAgB,MAGrC,QAA4D;QAA3D,EAAE,SAAS,EAAE,QAAQ,QAAQ,EAAE,aAAa,CAAC,EAAE,GAAG,OAAO;yBAC1D,6LAAC,gLAAuB;kBACtB,cAAA,6LAAC,iLAAwB;YACvB,KAAK;YACL,OAAO;YACP,YAAY;YACZ,WAAW,IAAA,4HAAE,EACX,8aACA;YAED,GAAG,KAAK;;;;;;;;;;;;;AAIf,eAAe,WAAW,GAAG,iLAAwB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 3092, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/ui/tooltip.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\";\nimport { cn } from \"~/lib/utils\";\n\nconst TooltipProvider = TooltipPrimitive.Provider;\n\nconst Tooltip = TooltipPrimitive.Root;\n\nconst TooltipTrigger = TooltipPrimitive.Trigger;\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Portal>\n    <TooltipPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </TooltipPrimitive.Portal>\n));\nTooltipContent.displayName = TooltipPrimitive.Content.displayName;\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };\n"],"names":[],"mappings":";;;;;;;;;;;AAEA;AACA;AACA;AAJA;;;;;AAMA,MAAM,kBAAkB,kLAAyB;AAEjD,MAAM,UAAU,8KAAqB;AAErC,MAAM,iBAAiB,iLAAwB;AAE/C,MAAM,+BAAiB,2KAAgB,MAGrC,QAA0C;QAAzC,EAAE,SAAS,EAAE,aAAa,CAAC,EAAE,GAAG,OAAO;yBACxC,6LAAC,gLAAuB;kBACtB,cAAA,6LAAC,iLAAwB;YACvB,KAAK;YACL,YAAY;YACZ,WAAW,IAAA,4HAAE,EACX,qXACA;YAED,GAAG,KAAK;;;;;;;;;;;;;AAIf,eAAe,WAAW,GAAG,iLAAwB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 3146, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/reactions/ReactionButton.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { Button } from \"~/components/ui/button\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"~/components/ui/popover\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"~/components/ui/tooltip\";\nimport { api } from \"~/lib/trpc/client\";\nimport { Heart, Sparkles, ThumbsUp, SmilePlus } from \"lucide-react\";\nimport { cn } from \"~/lib/utils\";\n\ninterface ReactionButtonProps {\n  postId?: string;\n  commentId?: string;\n  reactions: Array<{\n    type: string;\n    userId: string;\n  }>;\n  count: number;\n}\n\nconst DEFAULT_REACTIONS = [\n  { type: \"like\", icon: ThumbsUp, label: \"Like\" },\n  { type: \"wow\", icon: Sparkles, label: \"Wow\" },\n  { type: \"cool\", icon: Heart, label: \"Cool\" },\n];\n\nexport function ReactionButton({\n  postId,\n  commentId,\n  reactions,\n  count,\n}: ReactionButtonProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  const utils = api.useUtils();\n\n  const toggleMutation = api.reaction.toggle.useMutation({\n    onSuccess: () => {\n      if (postId) {\n        utils.post.feed.invalidate();\n        utils.post.getById.invalidate({ id: postId });\n      }\n      if (commentId) {\n        utils.comment.byPost.invalidate();\n      }\n    },\n  });\n\n  // Group reactions by type\n  const reactionCounts = reactions.reduce(\n    (acc, r) => {\n      acc[r.type] = (acc[r.type] || 0) + 1;\n      return acc;\n    },\n    {} as Record<string, number>\n  );\n\n  const handleReaction = (type: string) => {\n    toggleMutation.mutate({ type, postId, commentId });\n    setIsOpen(false);\n  };\n\n  const hasReactions = count > 0;\n\n  return (\n    <TooltipProvider>\n      <Popover open={isOpen} onOpenChange={setIsOpen}>\n        <PopoverTrigger asChild>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            className={cn(\n              \"gap-2 text-muted-foreground\",\n              hasReactions && \"text-primary\"\n            )}\n          >\n            {hasReactions ? (\n              <div className=\"flex -space-x-1\">\n                {Object.keys(reactionCounts)\n                  .slice(0, 3)\n                  .map((type) => {\n                    const reaction = DEFAULT_REACTIONS.find((r) => r.type === type);\n                    if (!reaction) return null;\n                    const Icon = reaction.icon;\n                    return (\n                      <div\n                        key={type}\n                        className=\"flex h-5 w-5 items-center justify-center rounded-full bg-primary/10 text-primary\"\n                      >\n                        <Icon className=\"h-3 w-3\" />\n                      </div>\n                    );\n                  })}\n              </div>\n            ) : (\n              <SmilePlus className=\"h-4 w-4\" />\n            )}\n            {count > 0 && <span>{count}</span>}\n          </Button>\n        </PopoverTrigger>\n        <PopoverContent className=\"w-auto p-2\" align=\"start\">\n          <div className=\"flex gap-1\">\n            {DEFAULT_REACTIONS.map((reaction) => {\n              const Icon = reaction.icon;\n              const userReacted = reactions.some(\n                (r) => r.type === reaction.type\n              );\n              const reactionCount = reactionCounts[reaction.type] || 0;\n\n              return (\n                <Tooltip key={reaction.type}>\n                  <TooltipTrigger asChild>\n                    <button\n                      onClick={() => handleReaction(reaction.type)}\n                      className={cn(\n                        \"flex h-10 w-10 items-center justify-center rounded-full transition-all hover:scale-110 hover:bg-muted\",\n                        userReacted && \"bg-primary/10 text-primary\"\n                      )}\n                    >\n                      <Icon className=\"h-5 w-5\" />\n                    </button>\n                  </TooltipTrigger>\n                  <TooltipContent>\n                    <p>\n                      {reaction.label}\n                      {reactionCount > 0 && ` (${reactionCount})`}\n                    </p>\n                  </TooltipContent>\n                </Tooltip>\n              );\n            })}\n          </div>\n        </PopoverContent>\n      </Popover>\n    </TooltipProvider>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3377, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/post/PostDetail.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/navigation\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"~/components/ui/avatar\";\nimport { Button } from \"~/components/ui/button\";\nimport { Badge } from \"~/components/ui/badge\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"~/components/ui/dropdown-menu\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\";\nimport { formatRelativeTime, getInitials } from \"~/lib/utils\";\nimport { ExternalLink, MoreHorizontal, Pencil, Trash2, Loader2 } from \"lucide-react\";\nimport { EditorContent } from \"~/components/editor/Editor\";\nimport { ReactionButton } from \"~/components/reactions/ReactionButton\";\nimport { api } from \"~/lib/trpc/client\";\nimport type { SerializedEditorState } from \"lexical\";\nimport { useSession } from \"next-auth/react\";\n\ninterface PostDetailProps {\n  post: {\n    id: string;\n    title: string | null;\n    content: unknown;\n    liveUrl: string | null;\n    createdAt: Date;\n    author: {\n      id: string;\n      displayName: string;\n      avatarUrl: string | null;\n    };\n    attachments: Array<{\n      id: string;\n      type: string;\n      url: string;\n      filename: string;\n      mimeType: string;\n      size: number;\n      thumbnailUrl: string | null;\n      width: number | null;\n      height: number | null;\n    }>;\n    projects: Array<{\n      project: {\n        id: string;\n        name: string;\n      };\n    }>;\n    reactions: Array<{\n      type: string;\n      userId: string;\n      user: {\n        id: string;\n        displayName: string;\n      };\n    }>;\n    _count: {\n      comments: number;\n    };\n  };\n}\n\nexport function PostDetail({ post }: PostDetailProps) {\n  const { data: session } = useSession();\n  const isAuthor = session?.user?.id === post.author.id;\n\n  return (\n    <article className=\"space-y-6\">\n      {/* Header */}\n      <header className=\"space-y-4\">\n        {/* Author info */}\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <Link href={`/user/${post.author.id}`}>\n              <Avatar className=\"h-12 w-12\">\n                <AvatarImage src={post.author.avatarUrl ?? undefined} />\n                <AvatarFallback>{getInitials(post.author.displayName)}</AvatarFallback>\n              </Avatar>\n            </Link>\n            <div>\n              <Link\n                href={`/user/${post.author.id}`}\n                className=\"font-medium hover:underline\"\n              >\n                {post.author.displayName}\n              </Link>\n              <p className=\"text-sm text-muted-foreground\">\n                {formatRelativeTime(new Date(post.createdAt))}\n              </p>\n            </div>\n          </div>\n          {isAuthor && (\n            <Button variant=\"ghost\" size=\"sm\" asChild>\n              <Link href={`/post/${post.id}/edit`} className=\"gap-2\">\n                <Pencil className=\"h-4 w-4\" />\n                Edit\n              </Link>\n            </Button>\n          )}\n        </div>\n\n        {/* Title */}\n        {post.title && (\n          <h1 className=\"text-3xl font-bold tracking-tight\">{post.title}</h1>\n        )}\n\n        {/* Projects */}\n        {post.projects.length > 0 && (\n          <div className=\"flex flex-wrap gap-2\">\n            {post.projects.map(({ project }) => (\n              <Link key={project.id} href={`/projects/${project.id}`}>\n                <Badge variant=\"secondary\" className=\"hover:bg-secondary/80\">\n                  {project.name}\n                </Badge>\n              </Link>\n            ))}\n          </div>\n        )}\n      </header>\n\n      {/* Content - attachments are rendered inline via EditorContent */}\n      <div className=\"prose prose-neutral dark:prose-invert max-w-none\">\n        <EditorContent content={post.content as SerializedEditorState} />\n      </div>\n\n      {/* Footer */}\n      <footer className=\"flex items-center justify-between border-t pt-4\">\n        <div className=\"flex items-center gap-4\">\n          <ReactionButton\n            postId={post.id}\n            reactions={post.reactions}\n            count={post.reactions.length}\n          />\n          <span className=\"text-sm text-muted-foreground\">\n            {post._count.comments} comments\n          </span>\n        </div>\n\n        {post.liveUrl && (\n          <Button variant=\"outline\" asChild>\n            <a\n              href={post.liveUrl}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"gap-2\"\n            >\n              View live\n              <ExternalLink className=\"h-4 w-4\" />\n            </a>\n          </Button>\n        )}\n      </footer>\n    </article>\n  );\n}\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AACA;AACA;AAgBA;AACA;AAAA;AACA;AACA;AAGA;;;AA7BA;;;;;;;;;;AA0EO,SAAS,WAAW,KAAyB;QAAzB,EAAE,IAAI,EAAmB,GAAzB;QAER;;IADjB,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,IAAA,sJAAU;IACpC,MAAM,WAAW,CAAA,oBAAA,+BAAA,gBAAA,QAAS,IAAI,cAAb,oCAAA,cAAe,EAAE,MAAK,KAAK,MAAM,CAAC,EAAE;QAWrB;IAThC,qBACE,6LAAC;QAAQ,WAAU;;0BAEjB,6LAAC;gBAAO,WAAU;;kCAEhB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC,0KAAI;wCAAC,MAAM,AAAC,SAAuB,OAAf,KAAK,MAAM,CAAC,EAAE;kDACjC,cAAA,6LAAC,+IAAM;4CAAC,WAAU;;8DAChB,6LAAC,oJAAW;oDAAC,KAAK,CAAA,yBAAA,KAAK,MAAM,CAAC,SAAS,cAArB,oCAAA,yBAAyB;;;;;;8DAC3C,6LAAC,uJAAc;8DAAE,IAAA,qIAAW,EAAC,KAAK,MAAM,CAAC,WAAW;;;;;;;;;;;;;;;;;kDAGxD,6LAAC;;0DACC,6LAAC,0KAAI;gDACH,MAAM,AAAC,SAAuB,OAAf,KAAK,MAAM,CAAC,EAAE;gDAC7B,WAAU;0DAET,KAAK,MAAM,CAAC,WAAW;;;;;;0DAE1B,6LAAC;gDAAE,WAAU;0DACV,IAAA,4IAAkB,EAAC,IAAI,KAAK,KAAK,SAAS;;;;;;;;;;;;;;;;;;4BAIhD,0BACC,6LAAC,+IAAM;gCAAC,SAAQ;gCAAQ,MAAK;gCAAK,OAAO;0CACvC,cAAA,6LAAC,0KAAI;oCAAC,MAAM,AAAC,SAAgB,OAAR,KAAK,EAAE,EAAC;oCAAQ,WAAU;;sDAC7C,6LAAC,mNAAM;4CAAC,WAAU;;;;;;wCAAY;;;;;;;;;;;;;;;;;;oBAQrC,KAAK,KAAK,kBACT,6LAAC;wBAAG,WAAU;kCAAqC,KAAK,KAAK;;;;;;oBAI9D,KAAK,QAAQ,CAAC,MAAM,GAAG,mBACtB,6LAAC;wBAAI,WAAU;kCACZ,KAAK,QAAQ,CAAC,GAAG,CAAC;gCAAC,EAAE,OAAO,EAAE;iDAC7B,6LAAC,0KAAI;gCAAkB,MAAM,AAAC,aAAuB,OAAX,QAAQ,EAAE;0CAClD,cAAA,6LAAC,6IAAK;oCAAC,SAAQ;oCAAY,WAAU;8CAClC,QAAQ,IAAI;;;;;;+BAFN,QAAQ,EAAE;;;;;;;;;;;;;;;;;0BAW7B,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC,0JAAa;oBAAC,SAAS,KAAK,OAAO;;;;;;;;;;;0BAItC,6LAAC;gBAAO,WAAU;;kCAChB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,sKAAc;gCACb,QAAQ,KAAK,EAAE;gCACf,WAAW,KAAK,SAAS;gCACzB,OAAO,KAAK,SAAS,CAAC,MAAM;;;;;;0CAE9B,6LAAC;gCAAK,WAAU;;oCACb,KAAK,MAAM,CAAC,QAAQ;oCAAC;;;;;;;;;;;;;oBAIzB,KAAK,OAAO,kBACX,6LAAC,+IAAM;wBAAC,SAAQ;wBAAU,OAAO;kCAC/B,cAAA,6LAAC;4BACC,MAAM,KAAK,OAAO;4BAClB,QAAO;4BACP,KAAI;4BACJ,WAAU;;gCACX;8CAEC,6LAAC,yOAAY;oCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOtC;GA5FgB;;QACY,sJAAU;;;KADtB","debugId":null}},
    {"offset": {"line": 3659, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { cn } from \"~/lib/utils\";\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  );\n});\nTextarea.displayName = \"Textarea\";\n\nexport { Textarea };\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAEA,MAAM,yBAAW,2KAAgB,MAG/B,QAA0B;QAAzB,EAAE,SAAS,EAAE,GAAG,OAAO;IACxB,qBACE,6LAAC;QACC,WAAW,IAAA,4HAAE,EACX,6QACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AACA,SAAS,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 3694, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/comments/CommentComposer.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback } from \"react\";\nimport { Button } from \"~/components/ui/button\";\nimport { Textarea } from \"~/components/ui/textarea\";\nimport { api } from \"~/lib/trpc/client\";\nimport { Loader2, Send } from \"lucide-react\";\n\ninterface CommentComposerProps {\n  postId: string;\n  parentId?: string;\n  attachmentId?: string;\n  coordinates?: {\n    x?: number;\n    y?: number;\n    width?: number;\n    height?: number;\n    timestamp?: number;\n  };\n  onSuccess?: () => void;\n  placeholder?: string;\n  compact?: boolean;\n}\n\nexport function CommentComposer({\n  postId,\n  parentId,\n  attachmentId,\n  coordinates,\n  onSuccess,\n  placeholder = \"Add a comment...\",\n  compact = false,\n}: CommentComposerProps) {\n  const [text, setText] = useState(\"\");\n  const utils = api.useUtils();\n\n  const createMutation = api.comment.create.useMutation({\n    onSuccess: () => {\n      setText(\"\");\n      utils.comment.byPost.invalidate({ postId });\n      utils.post.getById.invalidate({ id: postId });\n      onSuccess?.();\n    },\n  });\n\n  const handleSubmit = useCallback(\n    (e: React.FormEvent) => {\n      e.preventDefault();\n      if (!text.trim()) return;\n\n      // Create a simple Lexical editor state with the text\n      const content = {\n        root: {\n          children: [\n            {\n              children: [\n                {\n                  detail: 0,\n                  format: 0,\n                  mode: \"normal\",\n                  style: \"\",\n                  text: text.trim(),\n                  type: \"text\",\n                  version: 1,\n                },\n              ],\n              direction: \"ltr\",\n              format: \"\",\n              indent: 0,\n              type: \"paragraph\",\n              version: 1,\n            },\n          ],\n          direction: \"ltr\",\n          format: \"\",\n          indent: 0,\n          type: \"root\",\n          version: 1,\n        },\n      };\n\n      createMutation.mutate({\n        postId,\n        content,\n        parentId,\n        attachmentId,\n        coordinates,\n      });\n    },\n    [text, postId, parentId, attachmentId, coordinates, createMutation]\n  );\n\n  return (\n    <form onSubmit={handleSubmit} className=\"flex gap-2\">\n      <Textarea\n        value={text}\n        onChange={(e) => setText(e.target.value)}\n        placeholder={placeholder}\n        className={compact ? \"min-h-[60px]\" : \"min-h-[80px]\"}\n        disabled={createMutation.isPending}\n      />\n      <Button\n        type=\"submit\"\n        size={compact ? \"sm\" : \"default\"}\n        disabled={!text.trim() || createMutation.isPending}\n        className=\"shrink-0\"\n      >\n        {createMutation.isPending ? (\n          <Loader2 className=\"h-4 w-4 animate-spin\" />\n        ) : (\n          <Send className=\"h-4 w-4\" />\n        )}\n      </Button>\n    </form>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AAAA;;;AANA;;;;;;AAwBO,SAAS,gBAAgB,KAQT;QARS,EAC9B,MAAM,EACN,QAAQ,EACR,YAAY,EACZ,WAAW,EACX,SAAS,EACT,cAAc,kBAAkB,EAChC,UAAU,KAAK,EACM,GARS;;IAS9B,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAC;IACjC,MAAM,QAAQ,sIAAG,CAAC,QAAQ;IAE1B,MAAM,iBAAiB,sIAAG,CAAC,OAAO,CAAC,MAAM,CAAC,WAAW,CAAC;QACpD,SAAS;2DAAE;gBACT,QAAQ;gBACR,MAAM,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC;oBAAE;gBAAO;gBACzC,MAAM,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC;oBAAE,IAAI;gBAAO;gBAC3C,sBAAA,gCAAA;YACF;;IACF;IAEA,MAAM,eAAe,IAAA,4KAAW;qDAC9B,CAAC;YACC,EAAE,cAAc;YAChB,IAAI,CAAC,KAAK,IAAI,IAAI;YAElB,qDAAqD;YACrD,MAAM,UAAU;gBACd,MAAM;oBACJ,UAAU;wBACR;4BACE,UAAU;gCACR;oCACE,QAAQ;oCACR,QAAQ;oCACR,MAAM;oCACN,OAAO;oCACP,MAAM,KAAK,IAAI;oCACf,MAAM;oCACN,SAAS;gCACX;6BACD;4BACD,WAAW;4BACX,QAAQ;4BACR,QAAQ;4BACR,MAAM;4BACN,SAAS;wBACX;qBACD;oBACD,WAAW;oBACX,QAAQ;oBACR,QAAQ;oBACR,MAAM;oBACN,SAAS;gBACX;YACF;YAEA,eAAe,MAAM,CAAC;gBACpB;gBACA;gBACA;gBACA;gBACA;YACF;QACF;oDACA;QAAC;QAAM;QAAQ;QAAU;QAAc;QAAa;KAAe;IAGrE,qBACE,6LAAC;QAAK,UAAU;QAAc,WAAU;;0BACtC,6LAAC,mJAAQ;gBACP,OAAO;gBACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;gBACvC,aAAa;gBACb,WAAW,UAAU,iBAAiB;gBACtC,UAAU,eAAe,SAAS;;;;;;0BAEpC,6LAAC,+IAAM;gBACL,MAAK;gBACL,MAAM,UAAU,OAAO;gBACvB,UAAU,CAAC,KAAK,IAAI,MAAM,eAAe,SAAS;gBAClD,WAAU;0BAET,eAAe,SAAS,iBACvB,6LAAC,+NAAO;oBAAC,WAAU;;;;;yCAEnB,6LAAC,6MAAI;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAK1B;GA3FgB;;QAUA,sIAAG,CAAC;;;KAVJ","debugId":null}},
    {"offset": {"line": 3842, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/comments/CommentThread.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport Link from \"next/link\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"~/components/ui/avatar\";\nimport { Button } from \"~/components/ui/button\";\nimport { formatRelativeTime, getInitials } from \"~/lib/utils\";\nimport { ReactionButton } from \"~/components/reactions/ReactionButton\";\nimport { CommentComposer } from \"./CommentComposer\";\nimport { MessageCircle } from \"lucide-react\";\nimport type { SerializedEditorState } from \"lexical\";\n\ninterface CommentThreadProps {\n  comment: {\n    id: string;\n    content: unknown;\n    createdAt: Date;\n    author: {\n      id: string;\n      displayName: string;\n      avatarUrl: string | null;\n    };\n    replies: Array<{\n      id: string;\n      content: unknown;\n      createdAt: Date;\n      author: {\n        id: string;\n        displayName: string;\n        avatarUrl: string | null;\n      };\n      reactions: Array<{\n        type: string;\n        userId: string;\n      }>;\n    }>;\n    reactions: Array<{\n      type: string;\n      userId: string;\n    }>;\n  };\n  postId: string;\n}\n\nfunction extractPlainText(content: unknown): string {\n  if (!content || typeof content !== \"object\") return \"\";\n\n  const root = (content as Record<string, unknown>).root;\n  if (!root || typeof root !== \"object\") return \"\";\n\n  const children = (root as Record<string, unknown>).children;\n  if (!Array.isArray(children)) return \"\";\n\n  const texts: string[] = [];\n\n  function extractFromNode(node: unknown): void {\n    if (!node || typeof node !== \"object\") return;\n\n    const nodeObj = node as Record<string, unknown>;\n\n    if (nodeObj.type === \"text\" && typeof nodeObj.text === \"string\") {\n      texts.push(nodeObj.text);\n    }\n\n    if (Array.isArray(nodeObj.children)) {\n      nodeObj.children.forEach(extractFromNode);\n    }\n  }\n\n  children.forEach(extractFromNode);\n  return texts.join(\" \");\n}\n\nexport function CommentThread({ comment, postId }: CommentThreadProps) {\n  const [showReplyForm, setShowReplyForm] = useState(false);\n  const plainText = extractPlainText(comment.content);\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Main comment */}\n      <div className=\"flex gap-3\">\n        <Link href={`/user/${comment.author.id}`}>\n          <Avatar className=\"h-8 w-8\">\n            <AvatarImage src={comment.author.avatarUrl ?? undefined} />\n            <AvatarFallback className=\"text-xs\">\n              {getInitials(comment.author.displayName)}\n            </AvatarFallback>\n          </Avatar>\n        </Link>\n        <div className=\"flex-1\">\n          <div className=\"rounded-lg bg-muted px-3 py-2\">\n            <div className=\"flex items-center gap-2\">\n              <Link\n                href={`/user/${comment.author.id}`}\n                className=\"text-sm font-medium hover:underline\"\n              >\n                {comment.author.displayName}\n              </Link>\n              <span className=\"text-xs text-muted-foreground\">\n                {formatRelativeTime(new Date(comment.createdAt))}\n              </span>\n            </div>\n            <p className=\"mt-1 text-sm\">{plainText}</p>\n          </div>\n          <div className=\"mt-1 flex items-center gap-2\">\n            <ReactionButton\n              commentId={comment.id}\n              reactions={comment.reactions}\n              count={comment.reactions.length}\n            />\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              className=\"h-7 gap-1 px-2 text-xs text-muted-foreground\"\n              onClick={() => setShowReplyForm(!showReplyForm)}\n            >\n              <MessageCircle className=\"h-3 w-3\" />\n              Reply\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      {/* Reply form */}\n      {showReplyForm && (\n        <div className=\"ml-11\">\n          <CommentComposer\n            postId={postId}\n            parentId={comment.id}\n            onSuccess={() => setShowReplyForm(false)}\n            placeholder={`Reply to ${comment.author.displayName}...`}\n            compact\n          />\n        </div>\n      )}\n\n      {/* Replies */}\n      {comment.replies.length > 0 && (\n        <div className=\"ml-11 space-y-4 border-l-2 border-muted pl-4\">\n          {comment.replies.map((reply) => {\n            const replyText = extractPlainText(reply.content);\n            return (\n              <div key={reply.id} className=\"flex gap-3\">\n                <Link href={`/user/${reply.author.id}`}>\n                  <Avatar className=\"h-7 w-7\">\n                    <AvatarImage src={reply.author.avatarUrl ?? undefined} />\n                    <AvatarFallback className=\"text-xs\">\n                      {getInitials(reply.author.displayName)}\n                    </AvatarFallback>\n                  </Avatar>\n                </Link>\n                <div className=\"flex-1\">\n                  <div className=\"rounded-lg bg-muted px-3 py-2\">\n                    <div className=\"flex items-center gap-2\">\n                      <Link\n                        href={`/user/${reply.author.id}`}\n                        className=\"text-sm font-medium hover:underline\"\n                      >\n                        {reply.author.displayName}\n                      </Link>\n                      <span className=\"text-xs text-muted-foreground\">\n                        {formatRelativeTime(new Date(reply.createdAt))}\n                      </span>\n                    </div>\n                    <p className=\"mt-1 text-sm\">{replyText}</p>\n                  </div>\n                  <div className=\"mt-1\">\n                    <ReactionButton\n                      commentId={reply.id}\n                      reactions={reply.reactions}\n                      count={reply.reactions.length}\n                    />\n                  </div>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4180, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/ui/skeleton.tsx"],"sourcesContent":["import { cn } from \"~/lib/utils\";\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-primary/10\", className)}\n      {...props}\n    />\n  );\n}\n\nexport { Skeleton };\n"],"names":[],"mappings":";;;;;AAAA;;;AAEA,SAAS,SAAS,KAGqB;QAHrB,EAChB,SAAS,EACT,GAAG,OACkC,GAHrB;IAIhB,qBACE,6LAAC;QACC,WAAW,IAAA,4HAAE,EAAC,0CAA0C;QACvD,GAAG,KAAK;;;;;;AAGf;KAVS","debugId":null}},
    {"offset": {"line": 4210, "column": 0}, "map": {"version":3,"sources":["file:///Users/matejhrescak/src/draftboard/src/components/comments/CommentSection.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { api } from \"~/lib/trpc/client\";\nimport { CommentThread } from \"./CommentThread\";\nimport { CommentComposer } from \"./CommentComposer\";\nimport { Skeleton } from \"~/components/ui/skeleton\";\nimport { MessageCircle } from \"lucide-react\";\n\ninterface CommentSectionProps {\n  postId: string;\n}\n\nexport function CommentSection({ postId }: CommentSectionProps) {\n  const { data: comments, isLoading } = api.comment.byPost.useQuery({ postId });\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-4\">\n        <Skeleton className=\"h-6 w-24\" />\n        <Skeleton className=\"h-24\" />\n        <Skeleton className=\"h-32\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <h2 className=\"flex items-center gap-2 text-lg font-semibold\">\n        <MessageCircle className=\"h-5 w-5\" />\n        Comments\n        {comments && comments.length > 0 && (\n          <span className=\"text-muted-foreground\">({comments.length})</span>\n        )}\n      </h2>\n\n      {/* Comment composer */}\n      <CommentComposer postId={postId} />\n\n      {/* Comment threads */}\n      <div className=\"space-y-6\">\n        {comments && comments.length > 0 ? (\n          comments.map((comment) => (\n            <CommentThread key={comment.id} comment={comment} postId={postId} />\n          ))\n        ) : (\n          <p className=\"py-8 text-center text-sm text-muted-foreground\">\n            No comments yet. Be the first to comment!\n          </p>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAGA;AACA;AACA;AACA;AACA;;;AAPA;;;;;;AAaO,SAAS,eAAe,KAA+B;QAA/B,EAAE,MAAM,EAAuB,GAA/B;;IAC7B,MAAM,EAAE,MAAM,QAAQ,EAAE,SAAS,EAAE,GAAG,sIAAG,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC;QAAE;IAAO;IAE3E,IAAI,WAAW;QACb,qBACE,6LAAC;YAAI,WAAU;;8BACb,6LAAC,mJAAQ;oBAAC,WAAU;;;;;;8BACpB,6LAAC,mJAAQ;oBAAC,WAAU;;;;;;8BACpB,6LAAC,mJAAQ;oBAAC,WAAU;;;;;;;;;;;;IAG1B;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAG,WAAU;;kCACZ,6LAAC,4OAAa;wBAAC,WAAU;;;;;;oBAAY;oBAEpC,YAAY,SAAS,MAAM,GAAG,mBAC7B,6LAAC;wBAAK,WAAU;;4BAAwB;4BAAE,SAAS,MAAM;4BAAC;;;;;;;;;;;;;0BAK9D,6LAAC,uKAAe;gBAAC,QAAQ;;;;;;0BAGzB,6LAAC;gBAAI,WAAU;0BACZ,YAAY,SAAS,MAAM,GAAG,IAC7B,SAAS,GAAG,CAAC,CAAC,wBACZ,6LAAC,mKAAa;wBAAkB,SAAS;wBAAS,QAAQ;uBAAtC,QAAQ,EAAE;;;;8CAGhC,6LAAC;oBAAE,WAAU;8BAAiD;;;;;;;;;;;;;;;;;AAOxE;GAxCgB;KAAA","debugId":null}}]
}